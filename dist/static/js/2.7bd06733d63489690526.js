webpackJsonp([2],{"0bjJ":function(e,t){},"3Khb":function(e,t){},"3YI/":function(e,t){},"8uFk":function(e,t){},BlhW:function(e,t){},C7mh:function(e,t){},I4we:function(e,t){},Ov84:function(e,t){},TmV0:function(e,t,s){s("fZOM"),e.exports=s("FeBl").Object.values},Wbot:function(e,t){},YPgZ:function(e,t){},fZOM:function(e,t,s){var a=s("kM2E"),i=s("mbce")(!1);a(a.S,"Object",{values:function(e){return i(e)}})},gBkw:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),n=s("gRE1"),o=s.n(n),r=s("fZjL"),l=s.n(r),c={name:"ScenePreCaseSetTab",props:{tableData:null,tabHeader:null,tabHeight:null},data:function(){return{sourceHost:[],targetHost:[],hostList:[],tabDialog:!1,caseNameList:[],editReplaceChecked:!1,dialogVisible:!1,sceneDetail:{id:"",scene_name:"",project_id:"",business_id:"",create_person:"",version_id:"",is_replace_host:0,replace_host_config:""},tabData:[],loading:!1,sceneType:1,actionType:0}},methods:{tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"warning-row":"success-row"},isEmpty:function(e){return void 0===e||""===e},listIsEmpty:function(e){var t=!1;for(var s in e)if(this.isEmpty(e[s].project_id)||this.isEmpty(e[s].business_id)||this.isEmpty(e[s].id)){t=!0;break}return t},handleEditReplaceCheck:function(){this.editReplaceChecked?this.sceneDetail.is_replace_host=1:this.sceneDetail.is_replace_host=0},checkParentForEdit:function(){""!==this.sceneDetail.project_id&&void 0!==this.sceneDetail.project_id||this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForEdit:function(){var e=this;this.sceneDetail.business_id="",this.sceneDetail.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.sceneDetail.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.sceneDetail.project_list=t.data.data.projectList,e.sceneDetail.version_list=t.data.data.versionList,e.sceneDetail.business_list=t.data.data.businessList,t}).catch(function(e){return e})},checkParentForEditCase:function(e,t){"case"===e?""===this.tabData[t].project_id||""===this.tabData[t].business_id?this.$message({type:"error",message:"请先选择所属项目、所属业务!"}):this.getCaseList(t,"focus"):"business"===e&&""===this.tabData[t].project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForEditCase:function(e){var t=this;this.tabData[e].business_id="",this.tabData[e].id="",this.tabData[e].caseList=[];var s=String.format("{0}/caseInterface/caseConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.tabData[e].project_id);this.axios.get(s).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].project_list=s.data.data.projectList,t.tabData[e].business_list=s.data.data.businessList,s}).catch(function(e){return e})},getCaseList:function(e,t){var s=this;"change"===t&&(this.tabData[e].id=""),this.tabData[e].caseList=[];var a=String.format("{0}/sceneInterface/searchCaseByConditions",this.GLOBAL.MONITOR_URL);if(""!==this.tabData[e].project_id&&""!==this.tabData[e].business_id&&""!==this.sceneType){var n={project_id:this.tabData[e].project_id,business_id:this.tabData[e].business_id,case_type:this.sceneType};this.axios.post(a,i()(n),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"!==t.data.code&&s.$message.error(t.data.msg),s.tabData[e].caseList=t.data.caseList,t}).catch(function(e){return e})}else this.tabData[e].caseList=[]},executeScene:function(e){var t=this;this.loading=!0;var s=String.format("{0}/executeInterface/executeScene",this.GLOBAL.MONITOR_URL),a={id:e};this.axios.post(s,i()(a),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){var s=e.data.code;return t.loading=!1,"200"===s?t.Message.success("执行成功！"):t.Message.error(e.data.msg),e}).catch(function(e){return e}),setTimeout(function(){t.loading&&(t.loading=!1,t.$message.error("接口返回超时了,你可以继续等待或者重新请求～～～"))},3e4)},getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},editClick:function(e,t){var s=this;this.getHostList(),this.actionType=t;var a=String.format("{0}/sceneInterface/sceneInfo?id={1}",this.GLOBAL.MONITOR_URL,e);this.axios.get(a).then(function(e){return"200"!==e.data.code&&s.$message.error(e.data.msg),s.sceneDetail=e.data.scene_info,s.tabData=e.data.scene_info.case_info_list,1===s.sceneDetail.is_replace_host?s.editReplaceChecked=!0:s.editReplaceChecked=!1,s.sourceHost=l()(JSON.parse(s.sceneDetail.replace_host_config)),s.targetHost=o()(JSON.parse(s.sceneDetail.replace_host_config)),e}).catch(function(e){return e}),this.dialogVisible=!0},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},saveScene:function(){var e=this;if(this.isEmpty(this.sceneDetail.scene_name)||this.isEmpty(this.sceneDetail.create_person)||this.isEmpty(this.sceneDetail.project_id)||this.isEmpty(this.sceneDetail.business_id)||this.listIsEmpty(this.tabData))this.Message.error("警告:请填写必填项！");else if(!this.editReplaceChecked||0!==this.sourceHost.length&&0!==this.targetHost.length)if(this.editReplaceChecked&&this.sourceHost.length!==this.targetHost.length)this.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{this.sceneDetail.replace_host_config=this.handleHost();var t=[];for(var s in this.tabData){var a=this.tabData[s].id;t.push(a)}var n=0===this.actionType?String.format("{0}/sceneInterface/editScene",this.GLOBAL.MONITOR_URL):String.format("{0}/sceneInterface/addScene",this.GLOBAL.MONITOR_URL),o={id:this.sceneDetail.id,case_ids:t.join(","),scene_name:this.sceneDetail.scene_name,scene_type:this.sceneType,project_id:this.sceneDetail.project_id,create_person:this.sceneDetail.create_person,version_id:this.sceneDetail.version_id,business_id:this.sceneDetail.business_id,is_replace_host:this.sceneDetail.is_replace_host,replace_host_config:this.sceneDetail.replace_host_config};this.axios.post(n,i()(o),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"===t.data.code?(e.Message.success(t.data.msg),e.dialogVisible=!1):e.Message.error(t.data.msg),e.$emit("getSceneList"),t}).catch(function(t){return e.$emit("getSceneList"),t})}else this.Message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")},idsClick:function(e){var t=this;this.tabDialog=!0;var s={ids:e},a=String.format("{0}/sceneInterface/caseNameList",this.GLOBAL.MONITOR_URL);this.axios.post(a,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"!==e.data.code&&t.$message.error(e.data.msg),t.caseNameList=e.data.data.case_list,e}).catch(function(e){return e})},deleteScene:function(e){var t=this;this.$confirm("此操作将永久删除该场景, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={id:e},a=String.format("{0}/sceneInterface/removeScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?t.Message.success("删除成功！"):t.Message.error(e.data.msg),t.$emit("getSceneList"),e}).catch(function(e){return t.$emit("getSceneList"),e})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleAdd:function(e){this.tabData.splice(e,0,{project_id:"",project_list:[],business_id:"",business_list:[],id:"",caseList:[]});var t=this.tabData[e+1];this.$set(this.tabData,e+1,this.tabData[e]),this.$set(this.tabData,e,t),this.tabData[e+1].project_list=this.tabData[e].project_list},handleDelete:function(e){0===e?this.Message.error({message:"警告：请勿删除第一行！",center:!0}):this.tabData.splice(e,1)},clearEditPage:function(){this.tabData=[{project_id:"",project_list:[],business_id:"",business_list:[],id:"",caseList:[]}],this.sceneDetail.id="",this.sceneDetail.scene_name="",this.sceneDetail.project_id="",this.sceneDetail.business_id="",this.sceneDetail.create_person="",this.sceneDetail.version_id="",this.sceneDetail.is_replace_host=0,this.sceneDetail.replace_host_config="",this.sourceHost=[],this.targetHost=[],this.hostList=[]}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"-10px"},attrs:{"element-loading-text":"拼命执行中,请稍等,若一直无响应,30秒后自动关闭～～～","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.tableData,border:"",size:"mini","row-class-name":e.tableRowClassName}},[e._l(e.tabHeader,function(t,a){return["case_ids"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,width:"250px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.case_ids.split(",").length>5?t.row.case_ids.slice(0,12)+"...":t.row.case_ids)),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.idsClick(t.row.case_ids)}}},[e._v("查 看")])],1)]}}],null,!0)}):"id"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center",fixed:"",width:"100px","show-overflow-tooltip":""}}):"scene_name"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center",width:"250px","show-overflow-tooltip":""}}):"action"===t.type?s("el-table-column",{key:a,attrs:{label:t.label,align:"center","show-overflow-tooltip":"",width:"170px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"执行前请确认已配置好场景对应项目版本的参数池！",placement:"top"}},[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.executeScene(e.tableData[t.$index].id)}}},[e._v("执行\n            ")])],1),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.editClick(e.tableData[t.$index].id,0)}}},[e._v("编辑\n          ")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.deleteScene(e.tableData[t.$index].id)}}},[e._v("删除\n          ")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.editClick(e.tableData[t.$index].id,1)}}},[e._v("复制\n          ")])]}}],null,!0)}):s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center","show-overflow-tooltip":"",width:"150px"}})]})],2),e._v(" "),s("el-dialog",{attrs:{title:0===e.actionType?"编辑(场景id："+e.sceneDetail.id+")":"复制",visible:e.dialogVisible,width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearEditPage}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("前置场景")])]),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景名称:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:场景名称"},model:{value:e.sceneDetail.scene_name,callback:function(t){e.$set(e.sceneDetail,"scene_name",t)},expression:"sceneDetail.scene_name"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属项目:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:e.getConditionsForEdit},model:{value:e.sceneDetail.project_id,callback:function(t){e.$set(e.sceneDetail,"project_id",t)},expression:"sceneDetail.project_id"}},e._l(e.sceneDetail.project_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本:")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},on:{focus:e.checkParentForEdit},model:{value:e.sceneDetail.version_id,callback:function(t){e.$set(e.sceneDetail,"version_id",t)},expression:"sceneDetail.version_id"}},e._l(e.sceneDetail.version_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",filterable:"",clearable:""},on:{focus:e.checkParentForEdit},model:{value:e.sceneDetail.business_id,callback:function(t){e.$set(e.sceneDetail,"business_id",t)},expression:"sceneDetail.business_id"}},e._l(e.sceneDetail.business_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:创建人"},model:{value:e.sceneDetail.create_person,callback:function(t){e.$set(e.sceneDetail,"create_person",t)},expression:"sceneDetail.create_person"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("host替换: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("el-checkbox",{on:{change:e.handleEditReplaceCheck},model:{value:e.editReplaceChecked,callback:function(t){e.editReplaceChecked=t},expression:"editReplaceChecked"}},[e._v(e._s(e.editReplaceChecked?"是":"否")+"\n          ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host:")])]),e._v(" "),s("el-col",{attrs:{span:11,pull:2}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("目标host:")])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("前置用例表")])]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tabData,border:"",stripe:""}},[s("el-table-column",{attrs:{label:"所属项目",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getConditionsForEditCase(t.$index)}},model:{value:e.tabData[t.$index].project_id,callback:function(s){e.$set(e.tabData[t.$index],"project_id",s)},expression:"tabData[scope.$index].project_id"}},e._l(e.tabData[t.$index].project_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属业务",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getCaseList(t.$index,"change")},focus:function(s){return e.checkParentForEditCase("business",t.$index)}},model:{value:e.tabData[t.$index].business_id,callback:function(s){e.$set(e.tabData[t.$index],"business_id",s)},expression:"tabData[scope.$index].business_id"}},e._l(e.tabData[t.$index].business_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用例",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"590px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:function(s){return e.checkParentForEditCase("case",t.$index)}},model:{value:e.tabData[t.$index].id,callback:function(s){e.$set(e.tabData[t.$index],"id",s)},expression:"tabData[scope.$index].id"}},e._l(e.tabData[t.$index].caseList,function(e){return s("el-option",{key:e.id,attrs:{label:"["+e.version_name+"]["+e.id+"]"+e.case_name+":"+e.url,value:e.id}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.handleAdd(t.$index)}}},[e._v("插入\n            ")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n            ")])]}}])})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.saveScene}},[e._v("保 存")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"用例集列表",visible:e.tabDialog},on:{"update:visible":function(t){e.tabDialog=t}}},[s("el-table",{attrs:{data:e.caseNameList,border:"",size:"mini","max-height":"350px","row-class-name":e.tableRowClassName}},[s("el-table-column",{attrs:{property:"id",label:"用例id",width:"100px",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{property:"name",align:"center",label:"用例名称"}}),e._v(" "),s("el-table-column",{attrs:{property:"status",label:"状态",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.status?s("el-button",{attrs:{type:"danger",disabled:"",icon:"el-icon-close",circle:"",size:"mini"}}):1===t.row.status?s("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",disabled:"",size:"mini"}}):e._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(c,d,!1,function(e){s("BlhW")},"data-v-600aa3f9",null).exports,p=s("ppUw"),h=s.n(p),_={name:"ScenePreCaseSetBatchUpdate",data:function(){return{sourceHost:[],targetHost:[],hostList:[],copyProjectList:[],copyVersionList:[],copyForm:{pre_fix:"",scene_type:1,project_id:"",source_version_id:"",version_id:"",create_person:null===h.a.get("username")?"":h.a.get("username"),is_replace_host:1,replace_host_config:""},copyReplaceChecked:!0,rules:{source_version_id:[{required:!0,message:"源版本不能为空"}],project_id:[{required:!0,message:"所属项目不能为空"}],create_person:[{required:!0,message:"创建人不能为空"}]},copyVisible:!1}},methods:{getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},batchUpdateScene:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(!t.copyReplaceChecked||0!==t.sourceHost.length&&0!==t.targetHost.length)if(t.copyReplaceChecked&&t.sourceHost.length!==t.targetHost.length)t.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{t.copyForm.replace_host_config=t.handleHost();var s=t.$loading({lock:!0,text:"拼命更新中,请喝口水再来吧!(1分钟后自动关闭)",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){s.close(),t.clearCopyPage()},6e4);var a=String.format("{0}/sceneInterface/batchEditScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(t.copyForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?(t.clearCopyPage(),t.$message.success(e.data.msg)):t.$message.error(e.data.msg),t.$emit("search"),s.close(),e}).catch(function(e){return s.close(),e})}else t.$message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")})},openBatchUpdateDialog:function(){var e=this;this.getHostList(),this.copyVisible=!0;var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,t}).catch(function(e){return e})},getConditionsForCopy:function(){var e=this;this.copyForm.source_version_id="",this.copyForm.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,e.copyVersionList=t.data.data.versionList,t}).catch(function(e){return e})},checkParentForCopy:function(){""===this.copyForm.project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},clearCopyPage:function(){this.copyVisible=!1,this.$refs.copyForm.resetFields(),this.copyReplaceChecked=!0,this.sourceHost=[],this.targetHost=[],this.host=[]},handleCopyReplaceCheck:function(){this.copyReplaceChecked?this.copyForm.is_replace_host=1:this.copyForm.is_replace_host=0}}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"批量更新",visible:e.copyVisible,width:"80%"},on:{"update:visible":function(t){e.copyVisible=t},close:e.clearCopyPage}},[s("el-card",{staticClass:"box-card"},[s("el-form",{ref:"copyForm",attrs:{model:e.copyForm,rules:e.rules,inline:!0}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"所属项目",prop:"project_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditionsForCopy},model:{value:e.copyForm.project_id,callback:function(t){e.$set(e.copyForm,"project_id",t)},expression:"copyForm.project_id"}},e._l(e.copyProjectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"源版本",prop:"source_version_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.source_version_id,callback:function(t){e.$set(e.copyForm,"source_version_id",t)},expression:"copyForm.source_version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「所属项目」「源版本」字段是批量更新场景功能确定源版本(基准版本)的前提条件,请认真选择!\n          ")])],1),e._v(" "),s("el-divider"),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"名称前缀",prop:"pre_fix"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.pre_fix,callback:function(t){e.$set(e.copyForm,"pre_fix",t)},expression:"copyForm.pre_fix"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创建人",prop:"create_person"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:创建人",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.create_person,callback:function(t){e.$set(e.copyForm,"create_person",t)},expression:"copyForm.create_person"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"目标版本",prop:"version_id"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.version_id,callback:function(t){e.$set(e.copyForm,"version_id",t)},expression:"copyForm.version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("span",[e._v("host替换")])]),e._v(" "),s("el-col",{attrs:{span:1,pull:2}},[s("el-checkbox",{on:{change:e.handleCopyReplaceCheck},model:{value:e.copyReplaceChecked,callback:function(t){e.copyReplaceChecked=t},expression:"copyReplaceChecked"}},[e._v(e._s(e.copyReplaceChecked?"是":"否")+"\n            ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("目标host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「名称前缀」「创建人」「目标版本」「host替换」「源host」「目标host」字段是批量更新场景功能目标版本(更新后的版本)的基本信息,请认真填写!\n          ")])],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.clearCopyPage}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.batchUpdateScene("copyForm")}}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]};var f={name:"ScenePreCaseSetBatchCopy",data:function(){return{sourceHost:[],targetHost:[],hostList:[],copyProjectList:[],copyVersionList:[],copyForm:{pre_fix:"",scene_type:1,project_id:"",source_version_id:"",version_id:"",create_person:null===h.a.get("username")?"":h.a.get("username"),is_replace_host:1,replace_host_config:""},copyReplaceChecked:!0,rules:{pre_fix:[{required:!0,message:"名称前缀不能为空"}],source_version_id:[{required:!0,message:"源版本不能为空"}],project_id:[{required:!0,message:"所属项目不能为空"}],create_person:[{required:!0,message:"创建人不能为空"}],version_id:[{required:!0,message:"目标版本不能为空"}]},copyVisible:!1}},methods:{getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},handleCopyReplaceCheck:function(){this.copyReplaceChecked?this.copyForm.is_replace_host=1:this.copyForm.is_replace_host=0},openCopyDialog:function(){var e=this;this.getHostList(),this.copyVisible=!0;var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,t}).catch(function(e){return e})},getConditionsForCopy:function(){var e=this;this.copyForm.source_version_id="",this.copyForm.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,e.copyVersionList=t.data.data.versionList,t}).catch(function(e){return e})},checkParentForCopy:function(){""===this.copyForm.project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},clearCopyPage:function(){this.copyVisible=!1,this.$refs.copyForm.resetFields(),this.copyReplaceChecked=!0,this.sourceHost=[],this.targetHost=[],this.hostList=[]},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},batchCopyScene:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(!t.copyReplaceChecked||0!==t.sourceHost.length&&0!==t.targetHost.length)if(t.copyReplaceChecked&&t.sourceHost.length!==t.targetHost.length)t.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{t.copyForm.replace_host_config=t.handleHost();var s=t.$loading({lock:!0,text:"拼命复制中,请喝口水再来吧!(1分钟后自动关闭)",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){s.close(),t.clearCopyPage()},6e4);var a=String.format("{0}/sceneInterface/batchCopyScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(t.copyForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?(t.clearCopyPage(),t.$message.success(e.data.msg)):t.$message.error(e.data.msg),s.close(),t.$emit("search"),e}).catch(function(e){return s.close(),e})}else t.$message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")})}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"批量复制",visible:e.copyVisible,width:"80%"},on:{"update:visible":function(t){e.copyVisible=t},close:e.clearCopyPage}},[s("el-card",{staticClass:"box-card"},[s("el-form",{ref:"copyForm",attrs:{model:e.copyForm,rules:e.rules,inline:!0}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"所属项目",prop:"project_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditionsForCopy},model:{value:e.copyForm.project_id,callback:function(t){e.$set(e.copyForm,"project_id",t)},expression:"copyForm.project_id"}},e._l(e.copyProjectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"源版本",prop:"source_version_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.source_version_id,callback:function(t){e.$set(e.copyForm,"source_version_id",t)},expression:"copyForm.source_version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「所属项目」「源版本」字段是批量复制场景功能确定源版本(基准版本)的前提条件,请认真选择!\n          ")])],1),e._v(" "),s("el-divider"),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"名称前缀",prop:"pre_fix"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:名称前缀",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.pre_fix,callback:function(t){e.$set(e.copyForm,"pre_fix",t)},expression:"copyForm.pre_fix"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创建人",prop:"create_person"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:创建人",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.create_person,callback:function(t){e.$set(e.copyForm,"create_person",t)},expression:"copyForm.create_person"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"目标版本",prop:"version_id"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.version_id,callback:function(t){e.$set(e.copyForm,"version_id",t)},expression:"copyForm.version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("span",[e._v("host替换")])]),e._v(" "),s("el-col",{attrs:{span:1,pull:2}},[s("el-checkbox",{on:{change:e.handleCopyReplaceCheck},model:{value:e.copyReplaceChecked,callback:function(t){e.copyReplaceChecked=t},expression:"copyReplaceChecked"}},[e._v(e._s(e.copyReplaceChecked?"是":"否")+"\n            ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("目标host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「名称前缀」「创建人」「目标版本」「host替换」「源host」「目标host」字段是批量复制场景功能目标版本(复制后的版本)的基本信息,请认真填写!\n          ")])],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.clearCopyPage}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.batchCopyScene("copyForm")}}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]};var m={name:"ScenePreCaseSetList",components:{scenePreCaseSetTab:u,scenePreCaseSetBatchUpdate:s("VU/8")(_,v,!1,function(e){s("0bjJ")},"data-v-790d240e",null).exports,scenePreCaseSetBatchCopy:s("VU/8")(f,b,!1,function(e){s("Wbot")},"data-v-36a1cbfa",null).exports},data:function(){return{sourceHost:[],targetHost:[],hostList:[],tableData:[],projectList:[],projectId:"",businessList:[],businessId:"",createPerson:"",versionList:[],versionId:"",dialogVisible:!1,sceneDetail:{},dialogList:[],total:0,pageSize:0,currentPage:1,sceneId:"",sceneName:"",sceneType:1,addReplaceChecked:!1,addSceneName:"",addProjectList:[],addProjectId:"",addVersionList:[],addVersionId:"",addBusinessList:[],addBusinessId:"",addCreatePerson:null===h.a.get("username")?"":h.a.get("username"),addIsReplaceHost:0,addReplaceHostConfig:"",tableHeader:[],tabData:[{projectId:"",projectList:[],businessId:"",businessList:"",caseId:"",caseList:[]}]}},methods:{useBatchCopy:function(){this.$refs.batchCopy.openCopyDialog()},useBatchUpdate:function(){this.$refs.batchUpdate.openBatchUpdateDialog()},batchDeleteAndExecute:function(e){var t=this;if(""===this.projectId||""===this.versionId)this.$message({type:"error",message:"所属项目、项目版本字段不能为空!"});else{var s="delete"===e?"此操作将永久删除当前条件下的所有场景, 是否继续?":"此操作将批量执行当前条件下的所有场景, 是否继续?",a="delete"===e?"批量删除场景中,请稍后～～～(10秒后自动关闭！)":"批量执行场景中,请喝杯茶再来吧～～～(1分钟后自动关闭！)",n="delete"===e?1e4:6e4,o="delete"===e?String.format("{0}/sceneInterface/batchRemoveScene",this.GLOBAL.MONITOR_URL):String.format("{0}/executeInterface/batchExecuteScene",this.GLOBAL.MONITOR_URL),r="delete"===e?"已取消删除!":"已取消执行!";this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t.$loading({lock:!0,text:a,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){e.close()},n);var s={id:t.sceneId,scene_name:t.sceneName,scene_type:t.sceneType,project_id:t.projectId,version_id:t.versionId,business_id:t.businessId,create_person:t.createPerson};t.axios.post(o,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){return"200"===s.data.code?(e.close(),t.$message.success(s.data.msg)):(e.close(),t.Message.error(s.data.msg)),t.search(),s}).catch(function(e){return t.search(),e})}).catch(function(){t.$message({type:"info",message:r})})}},isEmpty:function(e){return void 0===e||""===e},listIsEmpty:function(e){var t=!1;for(var s in e)if(this.isEmpty(e[s].projectId)||this.isEmpty(e[s].businessId)||this.isEmpty(e[s].caseId)){t=!0;break}return t},handleAddReplaceCheck:function(){this.addReplaceChecked?this.addIsReplaceHost=1:this.addIsReplaceHost=0},checkParent:function(){""!==this.projectId&&void 0!==this.projectId||this.$message({type:"error",message:"请先选择所属项目!"})},reset:function(){this.initConditions(),this.getConditions(),this.getSceneList()},searchForTab:function(){this.getConditionsForTab(),this.getSceneList()},initConditions:function(){this.sceneId="",this.sceneName="",this.projectId="",this.businessId="",this.versionId="",this.currentPage=1},getConditions:function(){var e=this;this.businessId="",this.versionId="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.businessList=t.data.data.businessList,e.versionList=t.data.data.versionList,t}).catch(function(e){return e})},getConditionsForTab:function(){var e=this,t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.businessList=t.data.data.businessList,e.versionList=t.data.date.versionList,t}).catch(function(e){return e})},checkParentForAdd:function(){""!==this.addProjectId&&void 0!==this.addProjectId||this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForAdd:function(){var e=this;this.addBusinessId="",this.addCreatePerson=null===h.a.get("username")?"":h.a.get("username"),this.addVersionId="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.addProjectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.addProjectList=t.data.data.projectList,e.addVersionList=t.data.data.versionList,e.addBusinessList=t.data.data.businessList,t}).catch(function(e){return e})},checkParentForAddCase:function(e,t){"case"===e?""!==this.tabData[t].projectId&&""!==this.tabData[t].businessId||this.$message({type:"error",message:"请先选择所属项目、所属业务!"}):"business"===e&&""===this.tabData[t].projectId&&this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForAddCase:function(e){var t=this;this.tabData[e].businessId="",this.tabData[e].caseId="",this.tabData[e].caseList=[];var s=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.tabData[e].projectId);this.axios.get(s).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].projectList=s.data.data.projectList,t.tabData[e].businessList=s.data.data.businessList,s}).catch(function(e){return e})},getCaseList:function(e){var t=this;this.tabData[e].caseId="",this.tabData[e].caseList=[];var s=String.format("{0}/sceneInterface/searchCaseByConditions",this.GLOBAL.MONITOR_URL);if(""!==this.tabData[e].project_id&&""!==this.tabData[e].businessId&&""!==this.sceneType){var a={project_id:this.tabData[e].project_id,business_id:this.tabData[e].businessId,case_type:this.sceneType};this.axios.post(s,i()(a),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].caseList=s.data.caseList,s}).catch(function(e){return e})}else this.tabData[e].caseList=[]},getSceneList:function(){var e=this,t=String.format("{0}/sceneInterface/searchScene",this.GLOBAL.MONITOR_URL),s={id:this.sceneId,scene_name:this.sceneName,scene_type:this.sceneType,project_id:this.projectId,version_id:this.versionId,business_id:this.businessId,create_person:this.createPerson,page_index:this.currentPage};this.axios.post(t,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){"200"!==t.data.code&&e.$message.error(t.data.msg),e.total=t.data.total,e.pageSize=t.data.pageSize;var s=t.data.sceneInfo;return e.tableHeader=s.tableHeader,e.tableData=s.tableData,t}).catch(function(e){return e})},getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},openAddDialog:function(){var e=this;this.getHostList(),this.getConditionsForAdd();var t=String.format("{0}/projectInterface/projectListConditions",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.tabData[0].projectList=t.data.project_list,t}).catch(function(e){return e}),this.dialogVisible=!0},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},addScene:function(){var e=this;if(this.isEmpty(this.addSceneName)||this.isEmpty(this.addProjectId)||this.isEmpty(this.addCreatePerson)||this.listIsEmpty(this.tabData)||this.isEmpty(this.addBusinessId))this.Message.error("警告:请填写必填项！");else if(!this.addReplaceChecked||0!==this.sourceHost.length&&0!==this.targetHost.length)if(this.addReplaceChecked&&this.sourceHost.length!==this.targetHost.length)this.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{this.addReplaceHostConfig=this.handleHost();var t=[];for(var s in this.tabData){var a=this.tabData[s].caseId;t.push(a)}var n=String.format("{0}/sceneInterface/addScene",this.GLOBAL.MONITOR_URL),o={case_ids:t.join(","),scene_name:this.addSceneName,scene_type:this.sceneType,project_id:this.addProjectId,version_id:this.addVersionId,business_id:this.addBusinessId,create_person:this.addCreatePerson,is_replace_host:this.addIsReplaceHost,replace_host_config:this.addReplaceHostConfig};this.axios.post(n,i()(o),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"===t.data.code?(e.Message.success(t.data.msg),e.dialogVisible=!1):e.Message.error(t.data.msg),e.search(),t}).catch(function(t){return e.search(),t})}else this.Message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")},search:function(){this.currentPage=1,this.getSceneList()},handleAdd:function(e){this.tabData.splice(e,0,{projectId:"",projectList:[],businessId:"",businessList:[],caseId:"",caseList:[]});var t=this.tabData[e+1];this.$set(this.tabData,e+1,this.tabData[e]),this.$set(this.tabData,e,t),this.tabData[e+1].projectList=this.tabData[e].projectList},handleDelete:function(e){0===e?this.Message.error({message:"警告：请勿删除第一行！",center:!0}):this.tabData.splice(e,1)},clearAddPage:function(){this.tabData=[{projectId:"",projectList:[],businessId:"",businessList:[],caseId:"",caseList:[]}],this.addSceneName="",this.addProjectId="",this.addBusinessId="",this.addCreatePerson="",this.addIsReplaceHost=0,this.addReplaceHostConfig="",this.addReplaceChecked=!1,this.sourceHost=[],this.targetHost=[],this.hostList=[]}}},g={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("el-row",{staticStyle:{"margin-top":"-10px"},attrs:{gutter:40}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景id")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"输入场景id",clearable:"",size:"mini"},model:{value:e.sceneId,callback:function(t){e.sceneId=t},expression:"sceneId"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("名   称")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"输入场景名称",clearable:"",size:"mini"},model:{value:e.sceneName,callback:function(t){e.sceneName=t},expression:"sceneName"}})],1),e._v(" "),s("el-col",{attrs:{span:3,push:1}},[s("span",[e._v("所属项目")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditions},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.projectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"0px"},attrs:{gutter:20}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("项目版本")])]),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.versionId,callback:function(t){e.versionId=t},expression:"versionId"}},e._l(e.versionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("所属业务")])]),e._v(" "),s("el-col",{attrs:{span:4,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.businessId,callback:function(t){e.businessId=t},expression:"businessId"}},e._l(e.businessList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"输入创建人",clearable:"",size:"mini"},model:{value:e.createPerson,callback:function(t){e.createPerson=t},expression:"createPerson"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{float:"right"},attrs:{span:16}},[s("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:e.search}},[e._v("查询\n        ")]),e._v(" "),s("el-button",{attrs:{type:"success ",round:"",size:"mini"},on:{click:e.openAddDialog}},[e._v("新增\n        ")]),e._v(" "),s("el-button",{attrs:{type:"info",round:"",size:"mini"},on:{click:e.reset}},[e._v("重置\n        ")]),e._v(" "),s("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:e.useBatchCopy}},[e._v("批量复制\n        ")]),e._v(" "),s("el-button",{attrs:{round:"",size:"mini"},on:{click:e.useBatchUpdate}},[e._v("批量更新\n        ")]),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"执行前请确认已配置好场景对应项目版本的参数池！",placement:"top"}},[s("el-button",{attrs:{type:"warning",round:"",size:"mini"},on:{click:function(t){return e.batchDeleteAndExecute("execute")}}},[e._v("批量执行\n          ")])],1),e._v(" "),s("el-button",{attrs:{type:"batchDelete",size:"mini",round:""},on:{click:function(t){return e.batchDeleteAndExecute("delete")}}},[e._v("批量删除\n        ")])],1)],1)],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("scene-pre-case-set-tab",{attrs:{tableData:e.tableData,tabHeader:e.tableHeader},on:{getSceneList:e.getSceneList}})],1),e._v(" "),s("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearAddPage}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("前置场景")])]),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景名称: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:场景名称"},model:{value:e.addSceneName,callback:function(t){e.addSceneName=t},expression:"addSceneName"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属项目: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:e.getConditionsForAdd},model:{value:e.addProjectId,callback:function(t){e.addProjectId=t},expression:"addProjectId"}},e._l(e.addProjectList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本:")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择",clearable:"",filterable:""},on:{focus:e.checkParentForAdd},model:{value:e.addVersionId,callback:function(t){e.addVersionId=t},expression:"addVersionId"}},e._l(e.addVersionList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:e.checkParentForAdd},model:{value:e.addBusinessId,callback:function(t){e.addBusinessId=t},expression:"addBusinessId"}},e._l(e.addBusinessList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:创建人"},model:{value:e.addCreatePerson,callback:function(t){e.addCreatePerson=t},expression:"addCreatePerson"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("host替换: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("el-checkbox",{on:{change:e.handleAddReplaceCheck},model:{value:e.addReplaceChecked,callback:function(t){e.addReplaceChecked=t},expression:"addReplaceChecked"}},[e._v(e._s(e.addReplaceChecked?"是":"否")+"\n          ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host:")])]),e._v(" "),s("el-col",{attrs:{span:11,pull:2}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("目标host:")])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("前置用例表")])]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tabData,border:"",stripe:""}},[s("el-table-column",{attrs:{label:"所属项目",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getConditionsForAddCase(t.$index)}},model:{value:e.tabData[t.$index].projectId,callback:function(s){e.$set(e.tabData[t.$index],"projectId",s)},expression:"tabData[scope.$index].projectId"}},e._l(e.tabData[t.$index].projectList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属业务",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getCaseList(t.$index)},focus:function(s){return e.checkParentForAddCase("business",t.$index)}},model:{value:e.tabData[t.$index].businessId,callback:function(s){e.$set(e.tabData[t.$index],"businessId",s)},expression:"tabData[scope.$index].businessId"}},e._l(e.tabData[t.$index].businessList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用例",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"590px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:function(s){return e.checkParentForAddCase("case",t.$index)}},model:{value:e.tabData[t.$index].caseId,callback:function(s){e.$set(e.tabData[t.$index],"caseId",s)},expression:"tabData[scope.$index].caseId"}},e._l(e.tabData[t.$index].caseList,function(e){return s("el-option",{key:e.id,attrs:{label:"["+e.version_id+"]["+e.id+"]"+e.case_name+":"+e.url,value:e.id}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.handleAdd(t.$index)}}},[e._v("插入\n            ")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n            ")])]}}])})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.addScene}},[e._v("保 存")])],1)],1),e._v(" "),s("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":e.getSceneList,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[s("span",[e._v(e._s(e.pageSize)+"条/页")])]),e._v(" "),s("scene-pre-case-set-batch-update",{ref:"batchUpdate",on:{search:e.search}}),e._v(" "),s("scene-pre-case-set-batch-copy",{ref:"batchCopy",on:{search:e.search}})],1)},staticRenderFns:[]};var y=s("VU/8")(m,g,!1,function(e){s("3Khb")},"data-v-468c3943",null).exports,x={name:"SceneResultTable",components:{caseResultDialog:s("hjg1").a},props:{tabData:null,tabHeader:null,tabHeight:null},data:function(){return{dialogVisible:!1,sceneResultDetail:{},resultData:[]}},methods:{tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"warning-row":"success-row"},resultRowClassName:function(e){var t=e.row;return"失败"===t.status?"error-row":"未执行"===t.status?"warn-row":"normal-row"},lookClick:function(e){var t=this;this.dialogVisible=!0;var s=String.format("{0}/sceneInterface/sceneResultInfo?id={1}",this.GLOBAL.MONITOR_URL,e);this.axios.get(s).then(function(e){return"200"!==e.data.code&&t.$message.error(e.data.msg),t.sceneResultDetail=e.data.sceneResultInfo,t.resultData=e.data.sceneResultInfo.case_info_list,e}).catch(function(e){return e})}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{staticStyle:{width:"100%","margin-top":"-10px"},attrs:{data:e.tabData,border:"",size:"mini","row-class-name":e.tableRowClassName}},[e._l(e.tabHeader,function(t,a){return["id"===t.prop||"scene_id"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center","show-overflow-tooltip":"",fixed:"",width:"80px"}}):"scene_name"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center","show-overflow-tooltip":"",width:"250px"}}):"status"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center","show-overflow-tooltip":"",width:"80px",fixed:"right"}}):"action"===t.type?s("el-table-column",{key:a,attrs:{label:t.label,align:"center",fixed:"right",width:"80px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.lookClick(e.tabData[t.$index].id)}}},[e._v("查看\n          ")])]}}],null,!0)}):s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center",width:"150px","show-overflow-tooltip":""}})]})],2),e._v(" "),s("el-dialog",{attrs:{title:"查看",visible:e.dialogVisible,width:"85%",id:"resultTab"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("\n          "+e._s(e.sceneResultDetail.scene_type+"场景")+"\n        ")])]),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场  景  id:")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"场景id"},model:{value:e.sceneResultDetail.id,callback:function(t){e.$set(e.sceneResultDetail,"id",t)},expression:"sceneResultDetail.id"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("场景名称:")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"场景名称"},model:{value:e.sceneResultDetail.scene_name,callback:function(t){e.$set(e.sceneResultDetail,"scene_name",t)},expression:"sceneResultDetail.scene_name"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属项目: ")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"所属项目"},model:{value:e.sceneResultDetail.project_name,callback:function(t){e.$set(e.sceneResultDetail,"project_name",t)},expression:"sceneResultDetail.project_name"}})],1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本: ")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"项目版本"},model:{value:e.sceneResultDetail.project_version,callback:function(t){e.$set(e.sceneResultDetail,"project_version",t)},expression:"sceneResultDetail.project_version"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务: ")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"所属业务"},model:{value:e.sceneResultDetail.business_name,callback:function(t){e.$set(e.sceneResultDetail,"business_name",t)},expression:"sceneResultDetail.business_name"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("场景类型: ")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"场景类型"},model:{value:e.sceneResultDetail.scene_type,callback:function(t){e.$set(e.sceneResultDetail,"scene_type",t)},expression:"sceneResultDetail.scene_type"}})],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v(e._s(e.sceneResultDetail.scene_type)+"用例表")])]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.resultData,border:"","row-class-name":e.resultRowClassName}},[s("el-table-column",{attrs:{label:"所属项目",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{placeholder:"所属项目"},model:{value:e.resultData[t.$index].project_name,callback:function(s){e.$set(e.resultData[t.$index],"project_name",s)},expression:"resultData[scope.$index].project_name"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属业务",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{placeholder:"所属业务"},model:{value:e.resultData[t.$index].business_name,callback:function(s){e.$set(e.resultData[t.$index],"business_name",s)},expression:"resultData[scope.$index].business_name"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用例",align:"center",width:"500px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{placeholder:"用例"},model:{value:e.resultData[t.$index].case_value,callback:function(s){e.$set(e.resultData[t.$index],"case_value",s)},expression:"resultData[scope.$index].case_value"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"执行状态",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["成功"===e.resultData[t.$index].status?s("el-button",{attrs:{round:"",type:"success"},on:{click:function(s){return e.$refs.resultDialog.lookClick(e.resultData[t.$index].case_result_id)}}},[e._v("\n              "+e._s(e.resultData[t.$index].status)+"\n            ")]):"失败"===e.resultData[t.$index].status?s("el-button",{attrs:{round:"",type:"info"},on:{click:function(s){return e.$refs.resultDialog.lookClick(e.resultData[t.$index].case_result_id)}}},[e._v("\n              "+e._s(e.resultData[t.$index].status)+"\n            ")]):"未执行"===e.resultData[t.$index].status?s("el-button",{attrs:{round:""}},[e._v("\n              "+e._s(e.resultData[t.$index].status)+"\n            ")]):e._e()]}}])})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),s("case-result-dialog",{ref:"resultDialog"})],1)},staticRenderFns:[]};var k={name:"SceneResultList",components:{sceneResultTable:s("VU/8")(x,L,!1,function(e){s("I4we")},"data-v-b56118ea",null).exports},data:function(){return{sceneTypeList:[],projectList:[],projectId:"",versionList:[],versionId:"",businessList:[],businessId:[],useTimeList:[],statusList:[],total:0,pageSize:0,currentPage:1,dialogVisible:!1,sceneId:"",sceneName:"",sceneType:"",useTime:"",status:"",timeRange:[],endTime:"",tableHeader:[],tableData:[],pickerOptions2:this.GLOBAL.pickerOptions1}},methods:{checkParent:function(){""!==this.projectId&&void 0!==this.projectId||this.$message({type:"error",message:"请先选择所属项目!"})},reset:function(){this.initConditions(),this.getConditions(),this.getResultList()},searchForTab:function(){this.getConditionsForTab(),this.getResultList()},initConditions:function(){this.sceneId="",this.sceneName="",this.projectId="",this.businessId="",this.versionId="",this.sceneType="",this.status="",this.useTime="",this.currentPage=1},getConditions:function(){var e=this;this.versionId="",this.businessId="",this.versionList=[];var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.versionList=t.data.data.versionList,e.businessList=t.data.data.businessList,e.sceneTypeList=t.data.data.sceneTypeList,e.useTimeList=t.data.data.useTimeList,e.statusList=t.data.data.statusList,t}).catch(function(e){return e})},getConditionsForTab:function(){var e=this,t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.versionList=t.data.data.versionList,e.businessList=t.data.data.businessList,e.sceneTypeList=t.data.data.sceneTypeList,e.useTimeList=t.data.data.useTimeList,e.statusList=t.data.data.statusList,t}).catch(function(e){return e})},search:function(){this.currentPage=1,this.getResultList()},getResultList:function(){var e=this,t="",s="";null!=this.timeRange&&this.timeRange.length>0&&(t=this.timeRange[0],s=this.timeRange[1]);var a=String.format("{0}/sceneInterface/searchSceneResult",this.GLOBAL.MONITOR_URL),n={scene_id:this.sceneId,scene_name:this.sceneName,scene_type:this.sceneType,use_time:this.useTime,status:this.status,project_id:this.projectId,version_id:this.versionId,business_id:this.businessId,start_time:t,end_time:s,page_index:this.currentPage};this.axios.post(a,i()(n),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){"200"!==t.data.code&&e.$message.error(t.data.msg),e.total=t.data.total,e.pageSize=t.data.pageSize;var s=t.data.resultInfo;return e.tableHeader=s.tableHeader,e.tableData=s.tableData,t}).catch(function(e){return e})}}},D={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("el-row",{staticStyle:{"margin-top":"-10px"},attrs:{gutter:40}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景id")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"输入场景id",clearable:"",size:"mini"},model:{value:e.sceneId,callback:function(t){e.sceneId=t},expression:"sceneId"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("名   称")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"输入场景名称",clearable:"",size:"mini"},model:{value:e.sceneName,callback:function(t){e.sceneName=t},expression:"sceneName"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("所属项目")])]),e._v(" "),s("el-col",{attrs:{span:6,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{change:e.getConditions},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.projectList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.versionId,callback:function(t){e.versionId=t},expression:"versionId"}},e._l(e.versionList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.businessId,callback:function(t){e.businessId=t},expression:"businessId"}},e._l(e.businessList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("耗   时")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},model:{value:e.useTime,callback:function(t){e.useTime=t},expression:"useTime"}},e._l(e.useTimeList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("状   态")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("场景类型")])]),e._v(" "),s("el-col",{attrs:{span:6,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},model:{value:e.sceneType,callback:function(t){e.sceneType=t},expression:"sceneType"}},e._l(e.sceneTypeList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("日   期")])]),e._v(" "),s("el-col",{attrs:{span:6,pull:1}},[s("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"mini"},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),e._v(" "),s("el-col",{attrs:{span:4,push:3}},[s("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:e.search}},[e._v("查询\n        ")]),e._v(" "),s("el-button",{attrs:{type:"info",round:"",size:"mini"},on:{click:e.reset}},[e._v("重置\n        ")])],1)],1)],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("sceneResultTable",{attrs:{tabData:e.tableData,tabHeader:e.tableHeader,size:"mini"}})],1),e._v(" "),s("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":e.getResultList,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[s("span",[e._v(e._s(e.pageSize)+"条/页")])])],1)},staticRenderFns:[]};var C=s("VU/8")(k,D,!1,function(e){s("3YI/")},"data-v-40862f71",null).exports,R={name:"SceneCaseSetTab",props:{tableData:null,tabHeader:null,tabHeight:null},data:function(){return{sourceHost:[],targetHost:[],hostList:[],tabDialog:!1,caseNameList:[],editReplaceChecked:!1,dialogVisible:!1,sceneDetail:{id:"",scene_name:"",project_id:"",business_id:"",create_person:"",version_id:"",is_replace_host:0,replace_host_config:""},tabData:[],loading:!1,sceneType:0,actionType:0}},methods:{tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"warning-row":"success-row"},isEmpty:function(e){return void 0===e||""===e},listIsEmpty:function(e){var t=!1;for(var s in e)if(this.isEmpty(e[s].project_id)||this.isEmpty(e[s].business_id)||this.isEmpty(e[s].id)){t=!0;break}return t},handleEditReplaceCheck:function(){this.editReplaceChecked?this.sceneDetail.is_replace_host=1:this.sceneDetail.is_replace_host=0},checkParentForEdit:function(){""!==this.sceneDetail.project_id&&void 0!==this.sceneDetail.project_id||this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForEdit:function(){var e=this;this.sceneDetail.business_id="",this.sceneDetail.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.sceneDetail.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.sceneDetail.project_list=t.data.data.projectList,e.sceneDetail.version_list=t.data.data.versionList,e.sceneDetail.business_list=t.data.data.businessList,t}).catch(function(e){return e})},checkParentForEditCase:function(e,t){"case"===e?""===this.tabData[t].project_id||""===this.tabData[t].business_id?this.$message({type:"error",message:"请先选择所属项目、所属业务!"}):this.getCaseList(t,"focus"):"business"===e&&""===this.tabData[t].project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForEditCase:function(e){var t=this;this.tabData[e].business_id="",this.tabData[e].id="",this.tabData[e].caseList=[];var s=String.format("{0}/caseInterface/caseConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.tabData[e].project_id);this.axios.get(s).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].project_list=s.data.data.projectList,t.tabData[e].business_list=s.data.data.businessList,s}).catch(function(e){return e})},getCaseList:function(e,t){var s=this;"change"===t&&(this.tabData[e].id=""),this.tabData[e].caseList=[];var a=String.format("{0}/sceneInterface/searchCaseByConditions",this.GLOBAL.MONITOR_URL);if(""!==this.tabData[e].project_id&&""!==this.tabData[e].business_id&&""!==this.sceneType){var n={project_id:this.tabData[e].project_id,business_id:this.tabData[e].business_id,case_type:this.sceneType};this.axios.post(a,i()(n),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"!==t.data.code&&s.$message.error(t.data.msg),s.tabData[e].caseList=t.data.caseList,t}).catch(function(e){return e})}else this.tabData[e].caseList=[]},executeScene:function(e){var t=this;this.loading=!0;var s=String.format("{0}/executeInterface/executeScene",this.GLOBAL.MONITOR_URL),a={id:e};this.axios.post(s,i()(a),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){var s=e.data.code;return t.loading=!1,"200"===s?t.Message.success("执行成功！"):t.Message.error(e.data.msg),e}).catch(function(e){return e}),setTimeout(function(){t.loading&&(t.loading=!1,t.$message.error("接口返回超时了,你可以继续等待或者重新请求～～～"))},3e4)},getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},editClick:function(e,t){var s=this;this.getHostList(),this.actionType=t;var a=String.format("{0}/sceneInterface/sceneInfo?id={1}",this.GLOBAL.MONITOR_URL,e);this.axios.get(a).then(function(e){return"200"!==e.data.code&&s.$message.error(e.data.msg),s.sceneDetail=e.data.scene_info,s.tabData=e.data.scene_info.case_info_list,1===s.sceneDetail.is_replace_host?s.editReplaceChecked=!0:s.editReplaceChecked=!1,s.sourceHost=l()(JSON.parse(s.sceneDetail.replace_host_config)),s.targetHost=o()(JSON.parse(s.sceneDetail.replace_host_config)),e}).catch(function(e){return e}),this.dialogVisible=!0},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},saveScene:function(){var e=this;if(this.isEmpty(this.sceneDetail.scene_name)||this.isEmpty(this.sceneDetail.create_person)||this.isEmpty(this.sceneDetail.project_id)||this.isEmpty(this.sceneDetail.business_id)||this.listIsEmpty(this.tabData))this.Message.error("警告:请填写必填项！");else if(!this.editReplaceChecked||0!==this.sourceHost.length&&0!==this.targetHost.length)if(this.editReplaceChecked&&this.sourceHost.length!==this.targetHost.length)this.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{this.sceneDetail.replace_host_config=this.handleHost();var t=[];for(var s in this.tabData){var a=this.tabData[s].id;t.push(a)}var n=0===this.actionType?String.format("{0}/sceneInterface/editScene",this.GLOBAL.MONITOR_URL):String.format("{0}/sceneInterface/addScene",this.GLOBAL.MONITOR_URL),o={id:this.sceneDetail.id,case_ids:t.join(","),scene_name:this.sceneDetail.scene_name,scene_type:this.sceneType,project_id:this.sceneDetail.project_id,create_person:this.sceneDetail.create_person,version_id:this.sceneDetail.version_id,business_id:this.sceneDetail.business_id,is_replace_host:this.sceneDetail.is_replace_host,replace_host_config:this.sceneDetail.replace_host_config};this.axios.post(n,i()(o),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"===t.data.code?(e.Message.success(t.data.msg),e.dialogVisible=!1):e.Message.error(t.data.msg),e.$emit("getSceneList"),t}).catch(function(t){return e.$emit("getSceneList"),t})}else this.Message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")},idsClick:function(e){var t=this;this.tabDialog=!0;var s={ids:e},a=String.format("{0}/sceneInterface/caseNameList",this.GLOBAL.MONITOR_URL);this.axios.post(a,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"!==e.data.code&&t.$message.error(e.data.msg),t.caseNameList=e.data.data.case_list,e}).catch(function(e){return e})},deleteScene:function(e){var t=this;this.$confirm("此操作将永久删除该场景, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={id:e},a=String.format("{0}/sceneInterface/removeScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?t.Message.success("删除成功！"):t.Message.error(e.data.msg),t.$emit("getSceneList"),e}).catch(function(e){return t.$emit("getSceneList"),e})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleAdd:function(e){this.tabData.splice(e,0,{project_id:"",project_list:[],business_id:"",business_list:[],id:"",caseList:[]});var t=this.tabData[e+1];this.$set(this.tabData,e+1,this.tabData[e]),this.$set(this.tabData,e,t),this.tabData[e+1].project_list=this.tabData[e].project_list},handleDelete:function(e){0===e?this.Message.error({message:"警告：请勿删除第一行！",center:!0}):this.tabData.splice(e,1)},clearEditPage:function(){this.tabData=[{project_id:"",project_list:[],business_id:"",business_list:[],id:"",caseList:[]}],this.sceneDetail.id="",this.sceneDetail.scene_name="",this.sceneDetail.project_id="",this.sceneDetail.business_id="",this.sceneDetail.create_person="",this.sceneDetail.version_id="",this.sceneDetail.is_replace_host=0,this.sceneDetail.replace_host_config="",this.sourceHost=[],this.targetHost=[],this.hostList=[]}}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"-10px"},attrs:{"element-loading-text":"拼命执行中,请稍等,若一直无响应,30秒后自动关闭～～～","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.tableData,border:"",size:"mini","row-class-name":e.tableRowClassName}},[e._l(e.tabHeader,function(t,a){return["case_ids"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,width:"250px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.case_ids.split(",").length>5?t.row.case_ids.slice(0,12)+"...":t.row.case_ids)),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.idsClick(t.row.case_ids)}}},[e._v("查 看")])],1)]}}],null,!0)}):"id"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center",fixed:"",width:"100px","show-overflow-tooltip":""}}):"scene_name"===t.prop?s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center",width:"250px","show-overflow-tooltip":""}}):"action"===t.type?s("el-table-column",{key:a,attrs:{label:t.label,align:"center","show-overflow-tooltip":"",width:"170px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"执行前请确认已配置好场景对应项目版本的参数池！",placement:"top"}},[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.executeScene(e.tableData[t.$index].id)}}},[e._v("执行\n            ")])],1),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.editClick(e.tableData[t.$index].id,0)}}},[e._v("编辑\n          ")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.deleteScene(e.tableData[t.$index].id)}}},[e._v("删除\n          ")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){return e.editClick(e.tableData[t.$index].id,1)}}},[e._v("复制\n          ")])]}}],null,!0)}):s("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,align:"center","show-overflow-tooltip":"",width:"150px"}})]})],2),e._v(" "),s("el-dialog",{attrs:{title:0===e.actionType?"编辑(场景id："+e.sceneDetail.id+")":"复制",visible:e.dialogVisible,width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearEditPage}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("正式场景")])]),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景名称:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:场景名称"},model:{value:e.sceneDetail.scene_name,callback:function(t){e.$set(e.sceneDetail,"scene_name",t)},expression:"sceneDetail.scene_name"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属项目:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:e.getConditionsForEdit},model:{value:e.sceneDetail.project_id,callback:function(t){e.$set(e.sceneDetail,"project_id",t)},expression:"sceneDetail.project_id"}},e._l(e.sceneDetail.project_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本:")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},on:{focus:e.checkParentForEdit},model:{value:e.sceneDetail.version_id,callback:function(t){e.$set(e.sceneDetail,"version_id",t)},expression:"sceneDetail.version_id"}},e._l(e.sceneDetail.version_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务:"),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",filterable:"",clearable:""},on:{focus:e.checkParentForEdit},model:{value:e.sceneDetail.business_id,callback:function(t){e.$set(e.sceneDetail,"business_id",t)},expression:"sceneDetail.business_id"}},e._l(e.sceneDetail.business_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:创建人"},model:{value:e.sceneDetail.create_person,callback:function(t){e.$set(e.sceneDetail,"create_person",t)},expression:"sceneDetail.create_person"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("host替换: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("el-checkbox",{on:{change:e.handleEditReplaceCheck},model:{value:e.editReplaceChecked,callback:function(t){e.editReplaceChecked=t},expression:"editReplaceChecked"}},[e._v(e._s(e.editReplaceChecked?"是":"否")+"\n          ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host:")])]),e._v(" "),s("el-col",{attrs:{span:11,pull:2}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("目标host:")])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("正式用例表")])]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tabData,border:"",stripe:""}},[s("el-table-column",{attrs:{label:"所属项目",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getConditionsForEditCase(t.$index)}},model:{value:e.tabData[t.$index].project_id,callback:function(s){e.$set(e.tabData[t.$index],"project_id",s)},expression:"tabData[scope.$index].project_id"}},e._l(e.tabData[t.$index].project_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属业务",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getCaseList(t.$index,"change")},focus:function(s){return e.checkParentForEditCase("business",t.$index)}},model:{value:e.tabData[t.$index].business_id,callback:function(s){e.$set(e.tabData[t.$index],"business_id",s)},expression:"tabData[scope.$index].business_id"}},e._l(e.tabData[t.$index].business_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用例",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"590px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:function(s){return e.checkParentForEditCase("case",t.$index)}},model:{value:e.tabData[t.$index].id,callback:function(s){e.$set(e.tabData[t.$index],"id",s)},expression:"tabData[scope.$index].id"}},e._l(e.tabData[t.$index].caseList,function(e){return s("el-option",{key:e.id,attrs:{label:"["+e.version_name+"]["+e.id+"]"+e.case_name+":"+e.url,value:e.id}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.handleAdd(t.$index)}}},[e._v("插入\n            ")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n            ")])]}}])})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.saveScene}},[e._v("保 存")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"用例集列表",visible:e.tabDialog},on:{"update:visible":function(t){e.tabDialog=t}}},[s("el-table",{attrs:{data:e.caseNameList,border:"",size:"mini","max-height":"350px","row-class-name":e.tableRowClassName}},[s("el-table-column",{attrs:{property:"id",label:"用例id",width:"100px",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{property:"name",align:"center",label:"用例名称"}}),e._v(" "),s("el-table-column",{attrs:{property:"status",label:"状态",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.status?s("el-button",{attrs:{type:"danger",disabled:"",icon:"el-icon-close",circle:"",size:"mini"}}):1===t.row.status?s("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",disabled:"",size:"mini"}}):e._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var S={name:"SceneCaseSetBatchUpdate",data:function(){return{sourceHost:[],targetHost:[],hostList:[],copyProjectList:[],copyVersionList:[],copyForm:{pre_fix:"",scene_type:0,project_id:"",source_version_id:"",version_id:"",create_person:null===h.a.get("username")?"":h.a.get("username"),is_replace_host:1,replace_host_config:""},copyReplaceChecked:!0,rules:{source_version_id:[{required:!0,message:"源版本不能为空"}],project_id:[{required:!0,message:"所属项目不能为空"}],create_person:[{required:!0,message:"创建人不能为空"}]},copyVisible:!1}},methods:{getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},batchUpdateScene:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(!t.copyReplaceChecked||0!==t.sourceHost.length&&0!==t.targetHost.length)if(t.copyReplaceChecked&&t.sourceHost.length!==t.targetHost.length)t.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{t.copyForm.replace_host_config=t.handleHost();var s=t.$loading({lock:!0,text:"拼命更新中,请喝口水再来吧!(1分钟后自动关闭)",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){s.close(),t.clearCopyPage()},6e4);var a=String.format("{0}/sceneInterface/batchEditScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(t.copyForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?(t.clearCopyPage(),t.$message.success(e.data.msg)):t.$message.error(e.data.msg),t.$emit("search"),s.close(),e}).catch(function(e){return s.close(),e})}else t.$message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")})},openBatchUpdateDialog:function(){var e=this;this.getHostList(),this.copyVisible=!0;var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,t}).catch(function(e){return e})},getConditionsForCopy:function(){var e=this;this.copyForm.source_version_id="",this.copyForm.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,e.copyVersionList=t.data.data.versionList,t}).catch(function(e){return e})},checkParentForCopy:function(){""===this.copyForm.project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},clearCopyPage:function(){this.copyVisible=!1,this.$refs.copyForm.resetFields(),this.copyReplaceChecked=!0,this.sourceHost=[],this.targetHost=[],this.host=[]},handleCopyReplaceCheck:function(){this.copyReplaceChecked?this.copyForm.is_replace_host=1:this.copyForm.is_replace_host=0}}},j={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"批量更新",visible:e.copyVisible,width:"80%"},on:{"update:visible":function(t){e.copyVisible=t},close:e.clearCopyPage}},[s("el-card",{staticClass:"box-card"},[s("el-form",{ref:"copyForm",attrs:{model:e.copyForm,rules:e.rules,inline:!0}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"所属项目",prop:"project_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditionsForCopy},model:{value:e.copyForm.project_id,callback:function(t){e.$set(e.copyForm,"project_id",t)},expression:"copyForm.project_id"}},e._l(e.copyProjectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"源版本",prop:"source_version_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.source_version_id,callback:function(t){e.$set(e.copyForm,"source_version_id",t)},expression:"copyForm.source_version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「所属项目」「源版本」字段是批量更新场景功能确定源版本(基准版本)的前提条件,请认真选择!\n          ")])],1),e._v(" "),s("el-divider"),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"名称前缀",prop:"pre_fix"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.pre_fix,callback:function(t){e.$set(e.copyForm,"pre_fix",t)},expression:"copyForm.pre_fix"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创建人",prop:"create_person"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:创建人",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.create_person,callback:function(t){e.$set(e.copyForm,"create_person",t)},expression:"copyForm.create_person"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"目标版本",prop:"version_id"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.version_id,callback:function(t){e.$set(e.copyForm,"version_id",t)},expression:"copyForm.version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("span",[e._v("host替换")])]),e._v(" "),s("el-col",{attrs:{span:1,pull:2}},[s("el-checkbox",{on:{change:e.handleCopyReplaceCheck},model:{value:e.copyReplaceChecked,callback:function(t){e.copyReplaceChecked=t},expression:"copyReplaceChecked"}},[e._v(e._s(e.copyReplaceChecked?"是":"否")+"\n            ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("目标host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「名称前缀」「创建人」「目标版本」「host替换」「源host」「目标host」字段是批量更新场景功能目标版本(更新后的版本)的基本信息,请认真填写!\n          ")])],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.clearCopyPage}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.batchUpdateScene("copyForm")}}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]};var $={name:"SceneCaseSetBatchCopy",data:function(){return{sourceHost:[],targetHost:[],hostList:[],copyProjectList:[],copyVersionList:[],copyForm:{pre_fix:"",scene_type:0,project_id:"",source_version_id:"",version_id:"",create_person:null===h.a.get("username")?"":h.a.get("username"),is_replace_host:1,replace_host_config:""},copyReplaceChecked:!0,rules:{pre_fix:[{required:!0,message:"名称前缀不能为空"}],source_version_id:[{required:!0,message:"源版本不能为空"}],project_id:[{required:!0,message:"所属项目不能为空"}],create_person:[{required:!0,message:"创建人不能为空"}],version_id:[{required:!0,message:"目标版本不能为空"}]},copyVisible:!1}},methods:{getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return e.hostList=t.data.hostList,t}).catch(function(e){return e})},handleCopyReplaceCheck:function(){this.copyReplaceChecked?this.copyForm.is_replace_host=1:this.copyForm.is_replace_host=0},openCopyDialog:function(){var e=this;this.getHostList(),this.copyVisible=!0;var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,t}).catch(function(e){return e})},getConditionsForCopy:function(){var e=this;this.copyForm.source_version_id="",this.copyForm.version_id="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.copyForm.project_id);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.copyProjectList=t.data.data.projectList,e.copyVersionList=t.data.data.versionList,t}).catch(function(e){return e})},checkParentForCopy:function(){""===this.copyForm.project_id&&this.$message({type:"error",message:"请先选择所属项目!"})},clearCopyPage:function(){this.copyVisible=!1,this.$refs.copyForm.resetFields(),this.copyReplaceChecked=!0,this.sourceHost=[],this.targetHost=[],this.hostList=[]},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},batchCopyScene:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(!t.copyReplaceChecked||0!==t.sourceHost.length&&0!==t.targetHost.length)if(t.copyReplaceChecked&&t.sourceHost.length!==t.targetHost.length)t.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{t.copyForm.replace_host_config=t.handleHost();var s=t.$loading({lock:!0,text:"拼命复制中,请喝口水再来吧!(1分钟后自动关闭)",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){s.close(),t.clearCopyPage()},6e4);var a=String.format("{0}/sceneInterface/batchCopyScene",t.GLOBAL.MONITOR_URL);t.axios.post(a,i()(t.copyForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"200"===e.data.code?(t.clearCopyPage(),t.$message.success(e.data.msg)):t.$message.error(e.data.msg),s.close(),t.$emit("search"),e}).catch(function(e){return s.close(),e})}else t.$message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")})}}},w={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"批量复制",visible:e.copyVisible,width:"80%"},on:{"update:visible":function(t){e.copyVisible=t},close:e.clearCopyPage}},[s("el-card",{staticClass:"box-card"},[s("el-form",{ref:"copyForm",attrs:{model:e.copyForm,rules:e.rules,inline:!0}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"所属项目",prop:"project_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditionsForCopy},model:{value:e.copyForm.project_id,callback:function(t){e.$set(e.copyForm,"project_id",t)},expression:"copyForm.project_id"}},e._l(e.copyProjectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"源版本",prop:"source_version_id"}},[s("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.source_version_id,callback:function(t){e.$set(e.copyForm,"source_version_id",t)},expression:"copyForm.source_version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「所属项目」「源版本」字段是批量复制场景功能确定源版本(基准版本)的前提条件,请认真选择!\n          ")])],1),e._v(" "),s("el-divider"),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"名称前缀",prop:"pre_fix"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:名称前缀",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.pre_fix,callback:function(t){e.$set(e.copyForm,"pre_fix",t)},expression:"copyForm.pre_fix"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创建人",prop:"create_person"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:创建人",clearable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.copyForm.create_person,callback:function(t){e.$set(e.copyForm,"create_person",t)},expression:"copyForm.create_person"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"目标版本",prop:"version_id"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:function(t){return e.$forceUpdate()},focus:e.checkParentForCopy},model:{value:e.copyForm.version_id,callback:function(t){e.$set(e.copyForm,"version_id",t)},expression:"copyForm.version_id"}},e._l(e.copyVersionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("span",[e._v("host替换")])]),e._v(" "),s("el-col",{attrs:{span:1,pull:2}},[s("el-checkbox",{on:{change:e.handleCopyReplaceCheck},model:{value:e.copyReplaceChecked,callback:function(t){e.copyReplaceChecked=t},expression:"copyReplaceChecked"}},[e._v(e._s(e.copyReplaceChecked?"是":"否")+"\n            ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("目标host")])]),e._v(" "),s("el-col",{attrs:{span:10,pull:1}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[s("font",{attrs:{color:"#ff4500"}},[e._v("\n            注意事项:「名称前缀」「创建人」「目标版本」「host替换」「源host」「目标host」字段是批量复制场景功能目标版本(复制后的版本)的基本信息,请认真填写!\n          ")])],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.clearCopyPage}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.batchCopyScene("copyForm")}}},[e._v("确 定\n      ")])],1)],1)],1)},staticRenderFns:[]};var H={name:"SceneCaseSetList",components:{sceneCaseSetTab:s("VU/8")(R,I,!1,function(e){s("C7mh")},"data-v-c93ad61c",null).exports,sceneCaseSetBatchUpdate:s("VU/8")(S,j,!1,function(e){s("Ov84")},"data-v-3abe9372",null).exports,sceneCaseSetBatchCopy:s("VU/8")($,w,!1,function(e){s("nxG4")},"data-v-32369873",null).exports},data:function(){return{sourceHost:[],targetHost:[],hostList:[],tableData:[],projectList:[],projectId:"",businessList:[],businessId:"",createPerson:"",versionList:[],versionId:"",dialogVisible:!1,sceneDetail:{},dialogList:[],total:0,pageSize:0,currentPage:1,sceneId:"",sceneName:"",sceneType:0,addReplaceChecked:!1,addSceneName:"",addProjectList:[],addProjectId:"",addVersionList:[],addVersionId:"",addBusinessList:[],addBusinessId:"",addCreatePerson:null===h.a.get("username")?"":h.a.get("username"),addIsReplaceHost:0,addReplaceHostConfig:"",tableHeader:[],tabData:[{projectId:"",projectList:[],businessId:"",businessList:"",caseId:"",caseList:[]}]}},methods:{useBatchCopy:function(){this.$refs.batchCopy.openCopyDialog()},useBatchUpdate:function(){this.$refs.batchUpdate.openBatchUpdateDialog()},batchDeleteAndExecute:function(e){var t=this;if(""===this.projectId||""===this.versionId)this.$message({type:"error",message:"所属项目、项目版本字段不能为空!"});else{var s="delete"===e?"此操作将永久删除当前条件下的所有场景, 是否继续?":"此操作将批量执行当前条件下的所有场景, 是否继续?",a="delete"===e?"批量删除场景中,请稍后～～～(10秒后自动关闭！)":"批量执行场景中,请喝杯茶再来吧～～～(1分钟后自动关闭！)",n="delete"===e?1e4:6e4,o="delete"===e?String.format("{0}/sceneInterface/batchRemoveScene",this.GLOBAL.MONITOR_URL):String.format("{0}/executeInterface/batchExecuteScene",this.GLOBAL.MONITOR_URL),r="delete"===e?"已取消删除!":"已取消执行!";this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t.$loading({lock:!0,text:a,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout(function(){e.close()},n);var s={id:t.sceneId,scene_name:t.sceneName,scene_type:t.sceneType,project_id:t.projectId,version_id:t.version_id,business_id:t.businessId,create_person:t.createPerson};t.axios.post(o,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){return"200"===s.data.code?(e.close(),t.$message.success(s.data.msg)):(e.close(),t.Message.error(s.data.msg)),t.search(),s}).catch(function(e){return t.search(),e})}).catch(function(){t.$message({type:"info",message:r})})}},isEmpty:function(e){return void 0===e||""===e},listIsEmpty:function(e){var t=!1;for(var s in e)if(this.isEmpty(e[s].projectId)||this.isEmpty(e[s].businessId)||this.isEmpty(e[s].caseId)){t=!0;break}return t},handleAddReplaceCheck:function(){this.addReplaceChecked?this.addIsReplaceHost=1:this.addIsReplaceHost=0},checkParent:function(){""!==this.projectId&&void 0!==this.projectId||this.$message({type:"error",message:"请先选择所属项目!"})},reset:function(){this.initConditions(),this.getConditions(),this.getSceneList()},searchForTab:function(){this.getConditionsForTab(),this.getSceneList()},initConditions:function(){this.sceneId="",this.sceneName="",this.projectId="",this.businessId="",this.versionId="",this.currentPage=1},getConditions:function(){var e=this;this.businessId="",this.versionId="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.businessList=t.data.data.businessList,e.versionList=t.data.data.versionList,t}).catch(function(e){return e})},getConditionsForTab:function(){var e=this,t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.projectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.projectList=t.data.data.projectList,e.businessList=t.data.data.businessList,e.versionList=t.data.date.versionList,t}).catch(function(e){return e})},checkParentForAdd:function(){""!==this.addProjectId&&void 0!==this.addProjectId||this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForAdd:function(){var e=this;this.addBusinessId="",this.addCreatePerson=null===h.a.get("username")?"":h.a.get("username"),this.addVersionId="";var t=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.addProjectId);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.addProjectList=t.data.data.projectList,e.addVersionList=t.data.data.versionList,e.addBusinessList=t.data.data.businessList,t}).catch(function(e){return e})},checkParentForAddCase:function(e,t){"case"===e?""!==this.tabData[t].projectId&&""!==this.tabData[t].businessId||this.$message({type:"error",message:"请先选择所属项目、所属业务!"}):"business"===e&&""===this.tabData[t].projectId&&this.$message({type:"error",message:"请先选择所属项目!"})},getConditionsForAddCase:function(e){var t=this;this.tabData[e].businessId="",this.tabData[e].caseId="",this.tabData[e].caseList=[];var s=String.format("{0}/sceneInterface/sceneConditions?project_id={1}",this.GLOBAL.MONITOR_URL,this.tabData[e].projectId);this.axios.get(s).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].projectList=s.data.data.projectList,t.tabData[e].businessList=s.data.data.businessList,s}).catch(function(e){return e})},getCaseList:function(e){var t=this;this.tabData[e].caseId="",this.tabData[e].caseList=[];var s=String.format("{0}/sceneInterface/searchCaseByConditions",this.GLOBAL.MONITOR_URL);if(""!==this.tabData[e].project_id&&""!==this.tabData[e].businessId&&""!==this.sceneType){var a={project_id:this.tabData[e].project_id,business_id:this.tabData[e].businessId,case_type:this.sceneType};this.axios.post(s,i()(a),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){return"200"!==s.data.code&&t.$message.error(s.data.msg),t.tabData[e].caseList=s.data.caseList,s}).catch(function(e){return e})}else this.tabData[e].caseList=[]},getSceneList:function(){var e=this,t=String.format("{0}/sceneInterface/searchScene",this.GLOBAL.MONITOR_URL),s={id:this.sceneId,scene_name:this.sceneName,scene_type:this.sceneType,project_id:this.projectId,version_id:this.versionId,business_id:this.businessId,create_person:this.createPerson,page_index:this.currentPage};this.axios.post(t,i()(s),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){"200"!==t.data.code&&e.$message.error(t.data.msg),e.total=t.data.total,e.pageSize=t.data.pageSize;var s=t.data.sceneInfo;return e.tableHeader=s.tableHeader,e.tableData=s.tableData,t}).catch(function(e){return e})},getHostList:function(){var e=this,t=String.format("{0}/hostInterface/getHostList",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.hostList=t.data.hostList,t}).catch(function(e){return e})},openAddDialog:function(){var e=this;this.getHostList(),this.getConditionsForAdd();var t=String.format("{0}/projectInterface/projectListConditions",this.GLOBAL.MONITOR_URL);this.axios.get(t).then(function(t){return"200"!==t.data.code&&e.$message.error(t.data.msg),e.tabData[0].projectList=t.data.project_list,t}).catch(function(e){return e}),this.dialogVisible=!0},handleHost:function(){var e={},t=this.sourceHost.length,s=this.targetHost.length,a=[],n=[];t<s||t===s?(a=this.sourceHost,n=this.targetHost):(a=this.targetHost,n=this.sourceHost);for(var o=0;o<a.length;o++){var r=String(a[o]),l=n[o];e[r]=l}return i()(e)},addScene:function(){var e=this;if(this.isEmpty(this.addSceneName)||this.isEmpty(this.addProjectId)||this.isEmpty(this.addCreatePerson)||this.listIsEmpty(this.tabData)||this.isEmpty(this.addBusinessId))this.Message.error("警告:请填写必填项！");else if(!this.addReplaceChecked||0!==this.sourceHost.length&&0!==this.targetHost.length)if(this.addReplaceChecked&&this.sourceHost.length!==this.targetHost.length)this.Message.error("警告:勾选替换host后,「源host」「目标host」包含的host数量必须一致！");else{this.addReplaceHostConfig=this.handleHost();var t=[];for(var s in this.tabData){var a=this.tabData[s].caseId;t.push(a)}var n=String.format("{0}/sceneInterface/addScene",this.GLOBAL.MONITOR_URL),o={case_ids:t.join(","),scene_name:this.addSceneName,scene_type:this.sceneType,project_id:this.addProjectId,version_id:this.addVersionId,business_id:this.addBusinessId,create_person:this.addCreatePerson,is_replace_host:this.addIsReplaceHost,replace_host_config:this.addReplaceHostConfig};this.axios.post(n,i()(o),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"200"===t.data.code?(e.Message.success(t.data.msg),e.dialogVisible=!1):e.Message.error(t.data.msg),e.search(),t}).catch(function(t){return e.search(),t})}else this.Message.error("警告:勾选替换host后,「源host」「目标host」不能为空！")},search:function(){this.currentPage=1,this.getSceneList()},handleAdd:function(e){this.tabData.splice(e,0,{projectId:"",projectList:[],businessId:"",businessList:[],caseId:"",caseList:[]});var t=this.tabData[e+1];this.$set(this.tabData,e+1,this.tabData[e]),this.$set(this.tabData,e,t),this.tabData[e+1].projectList=this.tabData[e].projectList},handleDelete:function(e){0===e?this.Message.error({message:"警告：请勿删除第一行！",center:!0}):this.tabData.splice(e,1)},clearAddPage:function(){this.tabData=[{projectId:"",projectList:[],businessId:"",businessList:[],caseId:"",caseList:[]}],this.addSceneName="",this.addProjectId="",this.addBusinessId="",this.addCreatePerson="",this.addIsReplaceHost=0,this.addReplaceHostConfig="",this.addReplaceChecked=!1,this.sourceHost=[],this.targetHost=[],this.hostList=[]}}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("el-row",{staticStyle:{"margin-top":"-10px"},attrs:{gutter:40}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景id")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"输入场景id",clearable:"",size:"mini"},model:{value:e.sceneId,callback:function(t){e.sceneId=t},expression:"sceneId"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("名   称")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"输入场景名称",clearable:"",size:"mini"},model:{value:e.sceneName,callback:function(t){e.sceneName=t},expression:"sceneName"}})],1),e._v(" "),s("el-col",{attrs:{span:3,push:1}},[s("span",[e._v("所属项目")])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",size:"mini"},on:{change:e.getConditions},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.projectList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"0px"},attrs:{gutter:20}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("项目版本")])]),e._v(" "),s("el-col",{attrs:{span:3,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.versionId,callback:function(t){e.versionId=t},expression:"versionId"}},e._l(e.versionList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("所属业务")])]),e._v(" "),s("el-col",{attrs:{span:4,pull:1}},[s("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"mini"},on:{focus:e.checkParent},model:{value:e.businessId,callback:function(t){e.businessId=t},expression:"businessId"}},e._l(e.businessList,function(e){return s("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"输入创建人",clearable:"",size:"mini"},model:{value:e.createPerson,callback:function(t){e.createPerson=t},expression:"createPerson"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{float:"right"},attrs:{span:16}},[s("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:e.search}},[e._v("查询\n        ")]),e._v(" "),s("el-button",{attrs:{type:"success ",round:"",size:"mini"},on:{click:e.openAddDialog}},[e._v("新增\n        ")]),e._v(" "),s("el-button",{attrs:{type:"info",round:"",size:"mini"},on:{click:e.reset}},[e._v("重置\n        ")]),e._v(" "),s("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:e.useBatchCopy}},[e._v("批量复制\n        ")]),e._v(" "),s("el-button",{attrs:{round:"",size:"mini"},on:{click:e.useBatchUpdate}},[e._v("批量更新\n        ")]),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"执行前请确认已配置好场景对应项目版本的参数池！",placement:"top"}},[s("el-button",{attrs:{type:"warning",round:"",size:"mini"},on:{click:function(t){return e.batchDeleteAndExecute("execute")}}},[e._v("批量执行\n          ")])],1),e._v(" "),s("el-button",{attrs:{type:"batchDelete",size:"mini",round:""},on:{click:function(t){return e.batchDeleteAndExecute("delete")}}},[e._v("批量删除\n        ")])],1)],1)],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("sceneCaseSetTab",{attrs:{tableData:e.tableData,tabHeader:e.tableHeader},on:{getSceneList:e.getSceneList}})],1),e._v(" "),s("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearAddPage}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("正式场景")])]),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("场景名称: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:场景名称"},model:{value:e.addSceneName,callback:function(t){e.addSceneName=t},expression:"addSceneName"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属项目: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:e.getConditionsForAdd},model:{value:e.addProjectId,callback:function(t){e.addProjectId=t},expression:"addProjectId"}},e._l(e.addProjectList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("项目版本:")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择",clearable:"",filterable:""},on:{focus:e.checkParentForAdd},model:{value:e.addVersionId,callback:function(t){e.addVersionId=t},expression:"addVersionId"}},e._l(e.addVersionList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("span",[e._v("所属业务: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:e.checkParentForAdd},model:{value:e.addBusinessId,callback:function(t){e.addBusinessId=t},expression:"addBusinessId"}},e._l(e.addBusinessList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("创建人: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{clearable:"",placeholder:"必填项:创建人"},model:{value:e.addCreatePerson,callback:function(t){e.addCreatePerson=t},expression:"addCreatePerson"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("span",[e._v("host替换: "),s("span",{staticStyle:{color:"red"}},[e._v("*")])])]),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("el-checkbox",{on:{change:e.handleAddReplaceCheck},model:{value:e.addReplaceChecked,callback:function(t){e.addReplaceChecked=t},expression:"addReplaceChecked"}},[e._v(e._s(e.addReplaceChecked?"是":"否")+"\n          ")])],1),e._v(" "),s("el-col",{attrs:{span:2,pull:1}},[s("span",[e._v("源host:")])]),e._v(" "),s("el-col",{attrs:{span:11,pull:2}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.sourceHost,callback:function(t){e.sourceHost=t},expression:"sourceHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:2}},[s("span",[e._v("目标host:")])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-select",{staticStyle:{width:"450px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.targetHost,callback:function(t){e.targetHost=t},expression:"targetHost"}},e._l(e.hostList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label+":"+e.address,value:e.value+""}})}),1)],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("h1",[e._v("正式用例表")])]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tabData,border:"",stripe:""}},[s("el-table-column",{attrs:{label:"所属项目",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getConditionsForAddCase(t.$index)}},model:{value:e.tabData[t.$index].projectId,callback:function(s){e.$set(e.tabData[t.$index],"projectId",s)},expression:"tabData[scope.$index].projectId"}},e._l(e.tabData[t.$index].projectList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属业务",align:"center",width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(s){return e.getCaseList(t.$index)},focus:function(s){return e.checkParentForAddCase("business",t.$index)}},model:{value:e.tabData[t.$index].businessId,callback:function(s){e.$set(e.tabData[t.$index],"businessId",s)},expression:"tabData[scope.$index].businessId"}},e._l(e.tabData[t.$index].businessList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用例",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" "),s("el-select",{staticStyle:{width:"590px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{focus:function(s){return e.checkParentForAddCase("case",t.$index)}},model:{value:e.tabData[t.$index].caseId,callback:function(s){e.$set(e.tabData[t.$index],"caseId",s)},expression:"tabData[scope.$index].caseId"}},e._l(e.tabData[t.$index].caseList,function(e){return s("el-option",{key:e.id,attrs:{label:"["+e.version_id+"]["+e.id+"]"+e.case_name+":"+e.url,value:e.id}})}),1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.handleAdd(t.$index)}}},[e._v("插入\n            ")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n            ")])]}}])})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.addScene}},[e._v("保 存")])],1)],1),e._v(" "),s("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":e.getSceneList,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[s("span",[e._v(e._s(e.pageSize)+"条/页")])]),e._v(" "),s("scene-case-set-batch-update",{ref:"batchUpdate",on:{search:e.search}}),e._v(" "),s("scene-case-set-batch-copy",{ref:"batchCopy",on:{search:e.search}})],1)},staticRenderFns:[]};var T={components:{scenePreCaseSetList:y,sceneCaseSetList:s("VU/8")(H,F,!1,function(e){s("8uFk")},"data-v-0665c52a",null).exports,sceneResultList:C},data:function(){return{activeName:"scene"}},methods:{switchTab:function(){console.log(this.activeName),"scene"===this.activeName?this.$refs.sceneList.searchForTab():"sceneCaseSetList"===this.activeName?this.$refs.sceneCaseSetList.searchForTab():"sceneResult"===this.activeName&&this.$refs.sceneResult.searchForTab()}},mounted:function(){this.$refs.sceneList.searchForTab()}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.switchTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"scene"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-date"}),e._v("前置场景")]),e._v(" "),s("scene-pre-case-set-list",{ref:"sceneList"})],1),e._v(" "),s("el-tab-pane",{attrs:{name:"sceneCaseSetList"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-date"}),e._v("正式场景")]),e._v(" "),s("sceneCaseSetList",{ref:"sceneCaseSetList"})],1),e._v(" "),s("el-tab-pane",{attrs:{name:"sceneResult"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-date"}),e._v("测试结果")]),e._v(" "),s("sceneResultList",{ref:"sceneResult"})],1)],1)],1)},staticRenderFns:[]};var P=s("VU/8")(T,O,!1,function(e){s("YPgZ")},"data-v-bd9e4f4a",null);t.default=P.exports},gRE1:function(e,t,s){e.exports={default:s("TmV0"),__esModule:!0}},hjg1:function(e,t,s){"use strict";var a={name:"CaseResultDialog",props:{},data:function(){return{dialogVisible:!1,caseResultDetail:{}}},methods:{closeDialog:function(){this.caseResultDetail={},this.dialogVisible=!1},lookClick:function(e){var t=this;this.dialogVisible=!0;var s=String.format("{0}/caseInterface/caseResultInfo?id={1}",this.GLOBAL.MONITOR_URL,e);this.axios.get(s).then(function(e){return"200"!==e.data.code&&t.$message.error(e.data.msg),t.caseResultDetail=e.data.caseResultInfo,e}).catch(function(e){return e})}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"查看(结果id："+e.caseResultDetail.id+")",visible:e.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",[s("el-card",{staticClass:"box-card"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("用例id:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{model:{value:e.caseResultDetail.case_id,callback:function(t){e.$set(e.caseResultDetail,"case_id",t)},expression:"caseResultDetail.case_id"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("用例名称:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.case_name,callback:function(t){e.$set(e.caseResultDetail,"case_name",t)},expression:"caseResultDetail.case_name"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("所属项目:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.project,callback:function(t){e.$set(e.caseResultDetail,"project",t)},expression:"caseResultDetail.project"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("项目版本:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.project_version,callback:function(t){e.$set(e.caseResultDetail,"project_version",t)},expression:"caseResultDetail.project_version"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("所属业务:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.business,callback:function(t){e.$set(e.caseResultDetail,"business",t)},expression:"caseResultDetail.business"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("host地址:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.host,callback:function(t){e.$set(e.caseResultDetail,"host",t)},expression:"caseResultDetail.host"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("url地址:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.url,callback:function(t){e.$set(e.caseResultDetail,"url",t)},expression:"caseResultDetail.url"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("请求头部:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.header,callback:function(t){e.$set(e.caseResultDetail,"header",t)},expression:"caseResultDetail.header"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("请求参数:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.param,callback:function(t){e.$set(e.caseResultDetail,"param",t)},expression:"caseResultDetail.param"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("返回校验:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.check_nodes,callback:function(t){e.$set(e.caseResultDetail,"check_nodes",t)},expression:"caseResultDetail.check_nodes"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("请求类型:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{model:{value:e.caseResultDetail.request_type,callback:function(t){e.$set(e.caseResultDetail,"request_type",t)},expression:"caseResultDetail.request_type"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("用例类型:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.case_type,callback:function(t){e.$set(e.caseResultDetail,"case_type",t)},expression:"caseResultDetail.case_type"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("返回结果:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.response,callback:function(t){e.$set(e.caseResultDetail,"response",t)},expression:"caseResultDetail.response"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("执行状态:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{model:{value:e.caseResultDetail.status,callback:function(t){e.$set(e.caseResultDetail,"status",t)},expression:"caseResultDetail.status"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("失败原因:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.caseResultDetail.fail_reason,callback:function(t){e.$set(e.caseResultDetail,"fail_reason",t)},expression:"caseResultDetail.fail_reason"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("span",[e._v("请求耗时:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{model:{value:e.caseResultDetail.use_time,callback:function(t){e.$set(e.caseResultDetail,"use_time",t)},expression:"caseResultDetail.use_time"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:4}},[s("span",[e._v("创建时间:")])]),e._v(" "),s("el-col",{attrs:{span:8,pull:2}},[s("el-input",{model:{value:e.caseResultDetail.add_time,callback:function(t){e.$set(e.caseResultDetail,"add_time",t)},expression:"caseResultDetail.add_time"}})],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.closeDialog}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(e){s("iyhx")},"data-v-561a774d",null);t.a=n.exports},iyhx:function(e,t){},mbce:function(e,t,s){var a=s("lktj"),i=s("TcQ7"),n=s("NpIQ").f;e.exports=function(e){return function(t){for(var s,o=i(t),r=a(o),l=r.length,c=0,d=[];l>c;)n.call(o,s=r[c++])&&d.push(e?[s,o[s]]:o[s]);return d}}},nxG4:function(e,t){}});
//# sourceMappingURL=2.7bd06733d63489690526.js.map