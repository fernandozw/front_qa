webpackJsonp([4],{"+8kM":function(e,t){},"/lZE":function(e,t){},"4dgX":function(e,t){},KJeP:function(e,t,a){"use strict";var i=a("mvHQ"),s=a.n(i),l=a("6Bmd"),n=a("Xxa5"),o=a.n(n),r=a("exGp"),c=a.n(r),u=a("//Fk"),p=a.n(u),d=function(e){return new p.a(function(t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.src=e,a.onload=function(){t(function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height);var a=e.src.substring(e.src.lastIndexOf(".")+1).toLowerCase();return"jpg"===a&&(a="jpeg"),t.toDataURL("image/"+a)}(a))}})},m={name:"ExpectImageDialog",props:{expectImage:{type:Boolean,default:!1},stepId:{type:Number,default:null},compareType:{type:String,default:null}},data:function(){return{dialogImage:null,fileList:[],showImageDialog:!1,dialogVisible:!1,imageDetail:{stepId:null,completeImage:null,partImage:null},imageNum:1}},methods:{close:function(){this.$emit("listenToChildEvent",!1)},beforeAvatarUpload:function(e,t){e.size/1024/1024<10?this.fileList=t:this.$message.error("单张图片大小不能超过 10MB!")},previewImage:function(e){this.dialogImage=e.url,this.showImageDialog=!0},masterFileMax:function(e,t){this.$message.warning("请最多上传 "+this.imageNum+" 个文件。")},uploadImage:function(e){var t=this,a=String.format("{0}/expectImage/setExpectImage",this.GLOBAL.WEBUI_URL);this.axios.post(a,s()({imageDetail:this.imageDetail,compareType:this.compareType}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.close(),t.Message.success(e.data.msg)):t.Message.error(e.data.msg),e}).catch(function(e){return e})},saveImage:function(){var e=this;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("assertCompleteImage"!==e.compareType){t.next=14;break}if(!(e.fileList.length<1)){t.next=5;break}e.$message.warning("请上传完整对比的图片!"),t.next=12;break;case 5:return t.t0=e.stepId,t.next=8,d(e.fileList[0].url);case 8:return t.t1=t.sent,e.imageDetail={stepId:t.t0,completeImage:t.t1,partImage:null},t.next=12,e.uploadImage(e.imageDetail);case 12:t.next=42;break;case 14:if("assertPartialImage"!==e.compareType){t.next=28;break}if(!(e.fileList.length<1)){t.next=19;break}e.$message.warning("请上传局部对比的图片!"),t.next=26;break;case 19:return t.t2=e.stepId,t.next=22,d(e.fileList[0].url);case 22:return t.t3=t.sent,e.imageDetail={stepId:t.t2,completeImage:null,partImage:t.t3},t.next=26,e.uploadImage(e.imageDetail);case 26:t.next=42;break;case 28:if("assertCompleteOrPartialImage"!==e.compareType){t.next=42;break}if(!(e.fileList.length<2)){t.next=33;break}e.$message.warning("请上传局部对比和完整对比的图片!"),t.next=42;break;case 33:return t.t4=e.stepId,t.next=36,d(e.fileList[1].url);case 36:return t.t5=t.sent,t.next=39,d(e.fileList[0].url);case 39:t.t6=t.sent,e.imageDetail={stepId:t.t4,completeImage:t.t5,partImage:t.t6},e.uploadImage(e.imageDetail);case 42:case"end":return t.stop()}},t,e)}))()},removeImage:function(e,t){this.fileList=t},checkLimit:function(){var e=this.imageNum,t=this.$refs.upload;this.fileList.length===e?t.$children[1].$el.style.display="none":t.$children[1].$el.style.display=""},base64ImgToFile:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",a=e.split(","),i=a[0].match(/:(.*?);/)[1],s=i.split("/")[1],l=atob(a[1]),n=l.length,o=new Uint8Array(n);n--;)o[n]=l.charCodeAt(n);return new File([o],t+"."+s,{type:i})}},watch:{fileList:{handler:function(){this.checkLimit()}}},created:function(){this.dialogVisible=this.expectImage,"assertCompleteImage"===this.compareType||"assertPartialImage"===this.compareType?this.imageNum=1:"assertCompleteOrPartialImage"===this.compareType&&(this.imageNum=2)}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"image-dialog",attrs:{title:"",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("el-button",{attrs:{type:"text",size:"small"}},[e._v("设置图片("+e._s(e.compareType)+")\n      ")])],1),e._v(" "),a("el-upload",{ref:"upload",attrs:{action:"","auto-upload":!1,limit:e.imageNum,"on-change":e.beforeAvatarUpload,"on-exceed":e.masterFileMax,"on-preview":e.previewImage,"on-remove":e.removeImage,"list-type":"picture-card",multiple:""}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("div",{staticClass:"form-tips",staticStyle:{"margin-top":"10px"},attrs:{slot:"tip"},slot:"tip"},[1===e.imageNum?a("el-tag",{attrs:{type:"warning"}},[e._v("单张图片大小不能超过10MB!\n        ")]):2===e.imageNum?a("el-tag",{attrs:{type:"warning"}},[e._v("局部与完整混合对比模式下需要上传2张图片，第一张为局部图片，第二张为完整图片，单张图片大小不能超过\n          10MB!\n        ")]):e._e()],1)]),e._v(" "),a("el-dialog",{staticClass:"small-big-dialog",staticStyle:{"margin-left":"0px","margin-right":"0px"},attrs:{visible:e.showImageDialog,"append-to-body":"",width:"90%"},on:{"update:visible":function(t){e.showImageDialog=t}}},[a("el-image",{staticStyle:{width:"100%"},attrs:{src:e.dialogImage}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.saveImage}},[e._v("保 存")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.close}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(m,f,!1,function(e){a("YOHZ")},"data-v-3521a028",null).exports,g={name:"ImageDetailDialog",props:{expectImage:{type:Boolean,default:!1},stepId:{type:Number,default:null},compareType:{type:String,default:null}},data:function(){return{disableDeleteBtn:!0,dialogImage:null,fileList:[],showImageDialog:!1,dialogVisible:!1,imageDetail:{stepId:null,completeImage:null,partImage:null},isSetImage:!1,imageNum:1}},methods:{close:function(){this.$emit("listenToChildEvent",!1)},previewImage:function(e){this.dialogImage=e.url,this.showImageDialog=!0},masterFileMax:function(e,t){this.$message.warning("请最多上传 "+this.imageNum+" 个文件。")},detail:function(){var e=this,t=String.format("{0}/expectImage/getImage?stepId={1}",this.GLOBAL.WEBUI_URL,this.stepId);this.axios.get(t).then(function(t){return null!=t.data.data&&(e.isSetImage=!0,null!==t.data.data.partImage&&e.imgToUrl(t.data.data.partImage),null!==t.data.data.completeImage&&e.imgToUrl(t.data.data.completeImage)),t}).catch(function(e){return e})},checkLimit:function(){var e=this.imageNum,t=this.$refs.upload;this.fileList.length===e?t.$children[1].$el.style.display="none":t.$children[1].$el.style.display=""},imgToUrl:function(e){var t=this.base64ImgToFile(e),a={name:"img",url:window.webkitURL.createObjectURL(t)||window.URL.createObjectURL(t)};this.fileList.push(a)},base64ImgToFile:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",a=e.split(","),i=a[0].match(/:(.*?);/)[1],s=i.split("/")[1],l=atob(a[1]),n=l.length,o=new Uint8Array(n);n--;)o[n]=l.charCodeAt(n);return new File([o],t+"."+s,{type:i})}},watch:{fileList:{handler:function(){this.checkLimit()}}},created:function(){this.dialogVisible=this.expectImage,"assertCompleteImage"===this.compareType||"assertPartialImage"===this.compareType?this.imageNum=1:"assertCompleteAndPartialImage"===this.compareType&&(this.imageNum=2),this.detail()}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"image-dialog",attrs:{title:"",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",{attrs:{slot:"title"},slot:"title"},[e.isSetImage?a("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",size:"mini"}}):a("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:"",size:"mini"}}),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("查看图片("+e._s(e.compareType)+")")])],1),e._v(" "),a("el-upload",{ref:"upload",attrs:{disabled:e.disableDeleteBtn,action:"","auto-upload":!1,limit:e.imageNum,"on-exceed":e.masterFileMax,"on-preview":e.previewImage,"file-list":e.fileList,"list-type":"picture-card",multiple:""}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("div",{staticClass:"form-tips",staticStyle:{"margin-top":"10px"},attrs:{slot:"tip"},slot:"tip"},[1===e.imageNum?a("el-tag",{attrs:{type:"warning"}},[e._v("单张图片大小不能超过10MB!\n        ")]):2===e.imageNum?a("el-tag",{attrs:{type:"warning"}},[e._v("局部与完整混合对比模式下需要上传2张图片，第一张为局部图片，第二张为完整图片，单张图片大小不能超过\n          10MB!\n        ")]):e._e()],1)]),e._v(" "),a("el-dialog",{staticClass:"small-big-dialog",staticStyle:{"margin-left":"0px","margin-right":"0px"},attrs:{visible:e.showImageDialog,"append-to-body":"",width:"90%"},on:{"update:visible":function(t){e.showImageDialog=t}}},[a("el-image",{staticStyle:{width:"100%"},attrs:{src:e.dialogImage}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.close}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(g,b,!1,function(e){a("UzBv")},"data-v-18b54c76",null).exports,y={name:"WebUiCaseDialog",components:{noticeDialog:l.a,expectImageDialog:h,imageDetailDialog:v},props:{caseId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{imageStepId:null,compareType:"",imageList:["assertCompleteOrPartialImage","assertCompleteImage","assertPartialImage"],stepList:[{id:"",pageId:"",action:"",stepName:"",actionValue:"",function:"",status:"",verifyAction:"",verifyValue:"",paramKey:""}],actionList:[],actionParamMap:{},pageList:[],verifyList:[],statusList:[],dialogVisible:!0,noticeVisible:!1,imageVisible:!1,imageDetailVisible:!1,caseDetail:{caseName:"",pageId:"",pageType:"",phoneType:"",browserType:"",canUse:"",stepIds:""},pageTypeList:[],phoneTypeList:[],browserTypeList:[],pageVerifyList:[],canUseList:[],stepSelect:[],verifyMap:{}}},watch:{"caseDetail.pageType":{handler:function(e,t){"pc_web"===e&&e!==t&&(this.caseDetail.phoneType="")},deep:!0}},methods:{clickNotice:function(){this.noticeVisible=!0},clickImage:function(e,t){this.imageVisible=!0,this.imageStepId=e,this.compareType=t},clickImageDetail:function(e,t){this.imageDetailVisible=!0,this.imageStepId=e,this.compareType=t},callbackFunc:function(){this.noticeVisible=!1},callbackFuncForImage:function(){this.imageVisible=!1},callbackFuncForImageDetail:function(){this.imageDetailVisible=!1},changeForVerifyAction:function(e){this.stepList[e].verifyValue=""},changeforStep:function(e,t){var a=this,i=String.format("{0}/step/getStepDetailById?id={1}",this.GLOBAL.WEBUI_URL,e);this.axios.get(i).then(function(e){return a.stepList.splice(t,1,e.data.data.step),e}).catch(function(e){return e})},focusforStep:function(e){var t=this;this.stepSelect=[];var a=String.format("{0}/step/getStepListByPageId?pageId={1}",this.GLOBAL.WEBUI_URL,e);this.axios.get(a).then(function(e){return t.stepSelect=e.data.data,e}).catch(function(e){return e})},changeforPageId:function(e,t){var a=this;this.stepList[t]={id:"",pageId:e,action:"",stepName:"",actionValue:"",function:"",status:"",verifyAction:"",verifyValue:"",paramKey:""};var i=String.format("{0}/step/getStepListByPageId?pageId={1}",this.GLOBAL.WEBUI_URL,e);this.axios.get(i).then(function(e){return a.stepSelect=e.data.data,e}).catch(function(e){return e})},allStep:function(){var e=this,t=String.format("{0}/step/getAllStep",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.stepSelect=t.data.data,t}).catch(function(e){return e})},saveCase:function(){var e=this,t=String.format(2===this.type?"{0}/case/update":"{0}/case/add",this.GLOBAL.WEBUI_URL),a=this.stepList.map(function(e,t){return e.id}).join(",");this.caseDetail.stepIds=a;var i={uiCase:this.caseDetail,stepList:this.stepList};this.axios.post(t,s()(i),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"1000"===t.data.code?(e.Message.success(t.data.msg),e.$emit("listenToChildEvent",!0)):e.Message.error(t.data.msg),t}).catch(function(e){return e})},close:function(){this.$emit("listenToChildEvent",!1)},getStepConditions:function(){var e=this,t=String.format("{0}/step/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.actionList=t.data.data.actionList,e.actionParamMap=t.data.data.actionParamMap,e.pageList=t.data.data.pageList,e.statusList=t.data.data.statusList,e.verifyList=t.data.data.verifyList,e.verifyMap=t.data.data.verifyMap,t}).catch(function(e){return e})},getConditions:function(){var e=this,t=String.format("{0}/case/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.pageList=t.data.data.pageList,e.pageTypeList=t.data.data.pageTypeList,e.phoneTypeList=t.data.data.phoneTypeList,e.browserTypeList=t.data.data.browserTypeList,e.canUseList=t.data.data.canUseList,e.pageVerifyList=t.data.data.pageVerifyList,t}).catch(function(e){return e})},detail:function(){var e=this,t=String.format("{0}/case/getCaseById?id={1}",this.GLOBAL.WEBUI_URL,this.caseId);this.axios.get(t).then(function(t){return e.caseDetail=t.data.data.caseDetail,e.stepList=t.data.data.stepList.length>0?t.data.data.stepList:[{id:"",pageId:"",action:"",stepName:"",actionValue:"",function:"",status:"",verifyAction:"",verifyValue:""}],e.getConditions(),t}).catch(function(e){return e})},handleAdd:function(e){this.stepList.splice(e,0,{pageId:"",action:"",stepName:""});var t=this.stepList[e+1];this.$set(this.stepList,e+1,this.stepList[e]),this.$set(this.stepList,e,t)},handleDelete:function(e){0===e&&1===this.stepList.length?this.stepList=[{id:"",pageId:"",action:"",stepName:"",actionValue:"",function:"",status:"",verifyAction:"",verifyValue:""}]:this.stepList.splice(e,1)}},computed:{dialogTitle:function(){return 2===this.type?"编辑（用例ID："+this.caseId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){this.dialogVisible=this.visible,1===this.type?(this.getConditions(),this.getStepConditions()):2!==this.type&&3!==this.type||(this.detail(),this.getStepConditions(),this.allStep())}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"uiCase-dialog",attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"98%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a("el-card",{staticClass:"box-card",attrs:{id:"uiCaseBase"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("strong",[e._v("基础信息 ")])]),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.caseDetail,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"用例名称:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:请输入内容",clearable:""},model:{value:e.caseDetail.caseName,callback:function(t){e.$set(e.caseDetail,"caseName",t)},expression:"caseDetail.caseName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"页面类型:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择页面类型",clearable:""},model:{value:e.caseDetail.pageType,callback:function(t){e.$set(e.caseDetail,"pageType",t)},expression:"caseDetail.pageType"}},e._l(e.pageTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},["h5"===e.caseDetail.pageType?a("el-form-item",{attrs:{label:"手机类型:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择手机类型",clearable:""},model:{value:e.caseDetail.phoneType,callback:function(t){e.$set(e.caseDetail,"phoneType",t)},expression:"caseDetail.phoneType"}},e._l(e.phoneTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e()],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"浏览器类型:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择浏览器类型",clearable:""},model:{value:e.caseDetail.browserType,callback:function(t){e.$set(e.caseDetail,"browserType",t)},expression:"caseDetail.browserType"}},e._l(e.browserTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择状态",clearable:""},model:{value:e.caseDetail.canUse,callback:function(t){e.$set(e.caseDetail,"canUse",t)},expression:"caseDetail.canUse"}},e._l(e.canUseList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"所属业务:"}},[a("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},model:{value:e.caseDetail.pageId,callback:function(t){e.$set(e.caseDetail,"pageId",t)},expression:"caseDetail.pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.pageName,value:e.id}})}),1)],1)],1)],1)],1)],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("strong",[e._v("步骤信息")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"text",size:"mini"},on:{click:e.clickNotice}},[e._v("内置参数说明\n          ")])],1),e._v(" "),a("el-table",{staticStyle:{width:"98%"},attrs:{data:e.stepList,border:"",stripe:"",size:"mini"}},[a("el-table-column",{attrs:{label:"所属业务",align:"center",width:"210px",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(a){return e.changeforPageId(e.stepList[t.$index].pageId,t.$index)}},model:{value:e.stepList[t.$index].pageId,callback:function(a){e.$set(e.stepList[t.$index],"pageId",a)},expression:"stepList[scope.$index].pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.pageName,value:e.id}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"步骤名称",align:"center",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"210px"},attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(a){return e.changeforStep(e.stepList[t.$index].id,t.$index)},focus:function(a){return e.focusforStep(e.stepList[t.$index].pageId)}},model:{value:e.stepList[t.$index].id,callback:function(a){e.$set(e.stepList[t.$index],"id",a)},expression:"stepList[scope.$index].id"}},e._l(e.stepSelect,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.stepName,value:e.id}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.stepList[t.$index].action,callback:function(a){e.$set(e.stepList[t.$index],"action",a)},expression:"stepList[scope.$index].action"}},e._l(e.actionList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作值",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入操作值",clearable:""},model:{value:e.stepList[t.$index].actionValue,callback:function(a){e.$set(e.stepList[t.$index],"actionValue",a)},expression:"stepList[scope.$index].actionValue"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验类型",align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择",clearable:"",filterable:""},on:{change:function(a){return e.changeForVerifyAction(t.$index)}},model:{value:e.stepList[t.$index].verifyAction,callback:function(a){e.$set(e.stepList[t.$index],"verifyAction",a)},expression:"stepList[scope.$index].verifyAction"}},e._l(e.verifyList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"校验值",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.imageList.indexOf(e.stepList[t.$index].verifyAction)>-1?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.clickImage(e.stepList[t.$index].id,e.stepList[t.$index].verifyAction)}}},[e._v("设置图片")]):e._e(),e._v(" "),e.imageList.indexOf(e.stepList[t.$index].verifyAction)>-1?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.clickImageDetail(e.stepList[t.$index].id,e.stepList[t.$index].verifyAction)}}},[e._v("查看图片")]):a("el-input",{attrs:{placeholder:"输入校验值",clearable:"",disabled:!e.verifyMap[e.stepList[t.$index].verifyAction]},model:{value:e.stepList[t.$index].verifyValue,callback:function(a){e.$set(e.stepList[t.$index],"verifyValue",a)},expression:"stepList[scope.$index].verifyValue"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"外部函数",align:"center",width:"250PX"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入外部函数",clearable:""},model:{value:e.stepList[t.$index].function,callback:function(a){e.$set(e.stepList[t.$index],"function",a)},expression:"stepList[scope.$index].function"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.stepList[t.$index].status,callback:function(a){e.$set(e.stepList[t.$index],"status",a)},expression:"stepList[scope.$index].status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"保存参数",align:"center",width:"200PX"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入保存参数的key",clearable:"",disabled:"sendKeys"!==e.stepList[t.$index].action},model:{value:e.stepList[t.$index].paramKey,callback:function(a){e.$set(e.stepList[t.$index],"paramKey",a)},expression:"stepList[scope.$index].paramKey"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleAdd(t.$index)}}},[e._v("插入\n              ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n              ")])]}}])})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveCase}},[e._v("保 存\n      ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.close}},[e._v("关 闭")])],1)]),e._v(" "),e.noticeVisible?a("notice-dialog",{attrs:{notice:e.noticeVisible},on:{listenToChildEvent:e.callbackFunc}}):e._e(),e._v(" "),e.imageVisible?a("expect-image-dialog",{attrs:{expectImage:e.imageVisible,stepId:e.imageStepId,compareType:e.compareType},on:{listenToChildEvent:e.callbackFuncForImage}}):e._e(),e._v(" "),e.imageDetailVisible?a("image-detail-dialog",{attrs:{expectImage:e.imageDetailVisible,stepId:e.imageStepId,compareType:e.compareType},on:{listenToChildEvent:e.callbackFuncForImageDetail}}):e._e()],1)},staticRenderFns:[]};var L=a("VU/8")(y,x,!1,function(e){a("/lZE")},"data-v-131da27c",null);t.a=L.exports},NZqp:function(e,t){},OKnc:function(e,t,a){"use strict";var i=a("mvHQ"),s=a.n(i),l={name:"StepDialog",components:{noticeDialog:a("6Bmd").a},props:{stepId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{noticeVisible:!1,dialogVisible:!0,stepDetail:{stepName:"",elementId:"",action:"",actionValue:"",function:"",status:"",verifyAction:"",verifyValue:"",paramKey:""},actionList:[],actionParamMap:{},pageList:[],verifyList:[],verifyMap:{},statusList:[],statusMap:{},elementList:[]}},methods:{clickNotice:function(){this.noticeVisible=!0},callbackFunc:function(){this.noticeVisible=!1},changeVerifyAction:function(){this.stepDetail.verifyValue=""},changeAction:function(){this.stepDetail.actionValue="",this.stepDetail.paramKey=""},saveStep:function(){var e=this,t=String.format(2===this.type?"{0}/step/update":"{0}/step/add",this.GLOBAL.WEBUI_URL);this.axios.post(t,s()(this.stepDetail),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"1000"===t.data.code?(e.Message.success(t.data.msg),e.$emit("listenToChildEvent",!0)):e.Message.error(t.data.msg),t}).catch(function(e){return e})},changeForPage:function(e){var t=this;this.stepDetail.elementId="",this.elementList=[];var a=String.format("{0}//element/getElementByPageId?pageId={1}",this.GLOBAL.WEBUI_URL,e);this.axios.get(a).then(function(e){return t.elementList=e.data.data,e}).catch(function(e){return e})},close:function(){this.$emit("listenToChildEvent",!1)},getConditions:function(){var e=this,t=String.format("{0}/step/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.actionList=t.data.data.actionList,e.actionParamMap=t.data.data.actionParamMap,e.pageList=t.data.data.pageList,e.verifyList=t.data.data.verifyList,e.verifyMap=t.data.data.verifyMap,e.statusList=t.data.data.statusList,e.statusMap=t.data.data.statusMap,t}).catch(function(e){return e})},detail:function(){var e=this,t=String.format("{0}/step/getStepDetailById?id={1}",this.GLOBAL.WEBUI_URL,this.stepId);this.axios.get(t).then(function(t){return e.stepDetail=t.data.data.step,e.elementList=t.data.data.elementList,e.getConditions(),t}).catch(function(e){return e})}},computed:{dialogTitle:function(){return 2===this.type?"编辑（步骤ID："+this.stepId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){this.dialogVisible=this.visible,1===this.type?this.getConditions():2!==this.type&&3!==this.type||this.detail()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"step-dialog",attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"80%",id:"stepDialog"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a("el-button",{staticStyle:{"margin-top":"0px"},attrs:{type:"text",size:"mini"},on:{click:e.clickNotice}},[e._v("内置参数说明\n      ")]),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{inline:!0,model:e.stepDetail,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"步骤名称:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:请输入内容",clearable:""},model:{value:e.stepDetail.stepName,callback:function(t){e.$set(e.stepDetail,"stepName",t)},expression:"stepDetail.stepName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属业务:"}},[a("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},on:{change:function(t){return e.changeForPage(e.stepDetail.pageId)}},model:{value:e.stepDetail.pageId,callback:function(t){e.$set(e.stepDetail,"pageId",t)},expression:"stepDetail.pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:e.pageName,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属元素:"}},[a("el-select",{attrs:{placeholder:"必填项:请选择",clearable:"",filterable:""},model:{value:e.stepDetail.elementId,callback:function(t){e.$set(e.stepDetail,"elementId",t)},expression:"stepDetail.elementId"}},e._l(e.elementList,function(e){return a("el-option",{key:e.id,attrs:{label:e.elementName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作类型:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择操作类型",clearable:""},on:{change:e.changeAction},model:{value:e.stepDetail.action,callback:function(t){e.$set(e.stepDetail,"action",t)},expression:"stepDetail.action"}},e._l(e.actionList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"外部函数:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",clearable:""},model:{value:e.stepDetail.function,callback:function(t){e.$set(e.stepDetail,"function",t)},expression:"stepDetail.function"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"随操作值:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",clearable:""},model:{value:e.stepDetail.actionValue,callback:function(t){e.$set(e.stepDetail,"actionValue",t)},expression:"stepDetail.actionValue"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"校验类型:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择校验类型",clearable:""},on:{change:e.changeVerifyAction},model:{value:e.stepDetail.verifyAction,callback:function(t){e.$set(e.stepDetail,"verifyAction",t)},expression:"stepDetail.verifyAction"}},e._l(e.verifyList,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否启用:"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.stepDetail.status,callback:function(t){e.$set(e.stepDetail,"status",t)},expression:"stepDetail.status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"随校验值:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",clearable:""},model:{value:e.stepDetail.verifyValue,callback:function(t){e.$set(e.stepDetail,"verifyValue",t)},expression:"stepDetail.verifyValue"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"保存参数:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",clearable:"",disabled:"sendKeys"!==e.stepDetail.action},model:{value:e.stepDetail.paramKey,callback:function(t){e.$set(e.stepDetail,"paramKey",t)},expression:"stepDetail.paramKey"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveStep}},[e._v("\n        "+e._s(e.btnText)+"\n      ")])],1)]),e._v(" "),e.noticeVisible?a("notice-dialog",{attrs:{notice:e.noticeVisible},on:{listenToChildEvent:e.callbackFunc}}):e._e()],1)},staticRenderFns:[]};var o=a("VU/8")(l,n,!1,function(e){a("NZqp")},"data-v-14de25bc",null);t.a=o.exports},PBq9:function(e,t,a){"use strict";var i=a("mvHQ"),s=a.n(i),l={name:"ElementDialog",props:{elementId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{dialogVisible:!0,elementDetail:{elementName:"",iframe:"",locateType:"",keyword:"",pageId:""},locateList:[],pageList:[]}},methods:{saveElement:function(){var e=this,t=String.format(2===this.type?"{0}/element/update":"{0}/element/add",this.GLOBAL.WEBUI_URL);this.axios.post(t,s()(this.elementDetail),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"1000"===t.data.code?(e.Message.success(t.data.msg),e.$emit("listenToChildEvent",!0)):e.Message.error(t.data.msg),t}).catch(function(e){return e})},close:function(){this.$emit("listenToChildEvent",!1)},getConditions:function(){var e=this,t=String.format("{0}/element/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.locateList=t.data.data.locateList,e.pageList=t.data.data.pageList,t}).catch(function(e){return e})},detail:function(){var e=this,t=String.format("{0}/element/getElementById?id={1}",this.GLOBAL.WEBUI_URL,this.elementId);this.axios.get(t).then(function(t){return e.elementDetail=t.data.data,e.getConditions(),t}).catch(function(e){return e})}},computed:{dialogTitle:function(){return 2===this.type?"编辑（元素ID："+this.elementId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){this.dialogVisible=this.visible,1===this.type?this.getConditions():2!==this.type&&3!==this.type||this.detail()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"element-dialog",attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"80%",id:"elementDialog"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{inline:!0,model:e.elementDetail,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"元素名称:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:请输入内容",clearable:""},model:{value:e.elementDetail.elementName,callback:function(t){e.$set(e.elementDetail,"elementName",t)},expression:"elementDetail.elementName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"iframe:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:请输入内容",clearable:""},model:{value:e.elementDetail.iframe,callback:function(t){e.$set(e.elementDetail,"iframe",t)},expression:"elementDetail.iframe"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"定位方式:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择定位方式",clearable:""},model:{value:e.elementDetail.locateType,callback:function(t){e.$set(e.elementDetail,"locateType",t)},expression:"elementDetail.locateType"}},e._l(e.locateList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"关键字:"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项:请输入内容",clearable:""},model:{value:e.elementDetail.keyword,callback:function(t){e.$set(e.elementDetail,"keyword",t)},expression:"elementDetail.keyword"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属业务:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择所属业务",clearable:""},model:{value:e.elementDetail.pageId,callback:function(t){e.$set(e.elementDetail,"pageId",t)},expression:"elementDetail.pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.pageName,value:e.id}})}),1)],1)],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveElement}},[e._v("\n        "+e._s(e.btnText)+"\n      ")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(l,n,!1,function(e){a("PpZ9")},"data-v-51b6e6e6",null);t.a=o.exports},PpZ9:function(e,t){},UzBv:function(e,t){},YOHZ:function(e,t){},lDlj:function(e,t){},qF13:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("gBtx"),s=a.n(i),l=a("fZjL"),n=a.n(l),o=a("mvHQ"),r=a.n(o),c=a("KJeP"),u=a("OKnc"),p=a("PBq9"),d={name:"UiCaseResultList",components:{webUiCaseDialog:c.a,StepDialog:u.a,ElementDialog:p.a},data:function(){return{elementDialogVisibleType:2,elementId:null,elementDialogVisible:!1,stepDialogVisibleType:2,stepId:null,stepDialogVisible:!1,caseDialogVisibleType:2,caseId:null,caseDialogVisible:!1,failImgVisible:!1,loading:!0,imgSrc:"",failReasonVisible:!1,failReason:"",searchForm:{id:"",pageId:"",caseIds:"",caseName:"",status:"",addTime:[]},pageList:[],statusList:[],statusMap:{},tableData:[],caneMap:{},currentPage:1,pageSize:10,total:0}},methods:{setElementId:function(e){this.elementId=e,this.elementDialogVisible=!0},callbackFuncElement:function(){this.elementDialogVisible=!1},setStepId:function(e){this.stepId=e,this.stepDialogVisible=!0},callbackFuncStep:function(){this.stepDialogVisible=!1},setCaseId:function(e){this.caseId=e,this.caseDialogVisible=!0},callbackFunc:function(){this.caseDialogVisible=!1},tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"warning-row":"success-row"},getFailImg:function(e,t){var a=this;this.failImgVisible=!0;var i=String.format("{0}/result/failImage?id={1}&status={2}",this.GLOBAL.WEBUI_URL,e,t);this.axios.get(i).then(function(e){return a.imgSrc=e.data.failStepImage,e}).catch(function(e){return e})},setFailReason:function(e){this.failReason="",this.failReasonVisible=!0,this.failReason=e},getResultList:function(e){var t=this;"reset"===e?(this.currentPage=1,this.resetSearchForm()):"search"===e&&(this.currentPage=1);var a=String.format("{0}/result/resultList",this.GLOBAL.WEBUI_URL);this.searchForm.pageNum=this.currentPage,this.axios.post(a,r()(this.searchForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return t.tableData=e.data.data.resultList,t.total=e.data.data.total,e}).catch(function(e){return e})},getResultListByUrl:function(e){var t=this;this.searchForm=e;var a=String.format("{0}/result/resultList",this.GLOBAL.WEBUI_URL);this.searchForm.pageNum=this.currentPage,this.axios.post(a,r()(this.searchForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return t.tableData=e.data.data.resultList,t.total=e.data.data.total,e}).catch(function(e){return e})},getConditions:function(){var e=this,t=String.format("{0}/result/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.pageList=t.data.data.pageList,e.statusList=t.data.data.statusList,e.statusMap=t.data.data.statusMap,t}).catch(function(e){return e})},resetSearchForm:function(){this.searchForm={id:"",pageId:"",caseIds:"",caseName:"",status:"",addTime:[]}}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"结果id"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"输入结果id",clearable:""},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属业务"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.searchForm.pageId,callback:function(t){e.$set(e.searchForm,"pageId",t)},expression:"searchForm.pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.pageName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用例id"}},[a("el-input",{attrs:{placeholder:"输入用例id,多个id以','分割",clearable:""},model:{value:e.searchForm.caseIds,callback:function(t){e.$set(e.searchForm,"caseIds",t)},expression:"searchForm.caseIds"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用例名称"}},[a("el-input",{attrs:{placeholder:"输入用例名称",clearable:""},model:{value:e.searchForm.caseName,callback:function(t){e.$set(e.searchForm,"caseName",t)},expression:"searchForm.caseName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行结果"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"执行时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchForm.addTime,callback:function(t){e.$set(e.searchForm,"addTime",t)},expression:"searchForm.addTime"}})],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right","margin-right":"60px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getResultList("search")}}},[e._v("查询\n      ")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.getResultList("reset")}}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini",border:"","cell-style":{"text-align":"center"},"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{fixed:"left",prop:"id",label:"结果id",width:"100","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"left",prop:"pageId",label:"所属业务",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==e.tableData[t.$index].pageId?a("span",[e._v("\n          「"+e._s(e.tableData[t.$index].pageId)+"」"+e._s(e.tableData[t.$index].pageName)+"\n        ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属用例",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.setCaseId(e.tableData[t.$index].caseId)}}},[e._v("「"+e._s(e.tableData[t.$index].caseId)+"」"+e._s(e.tableData[t.$index].caseName)+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"失败元素",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==e.tableData[t.$index].elementId?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.setElementId(e.tableData[t.$index].elementId)}}},[e._v("「"+e._s(e.tableData[t.$index].elementId)+"」"+e._s(e.tableData[t.$index].elementName)+"\n        ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"失败步骤",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==e.tableData[t.$index].failStepId?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.setStepId(e.tableData[t.$index].failStepId)}}},[e._v("「"+e._s(e.tableData[t.$index].failStepId)+"」"+e._s(e.tableData[t.$index].stepName)+"\n        ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"执行结果",width:"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.statusMap[e.tableData[t.$index].status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"usetime",label:"执行耗时",width:"180","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"addTime",label:"执行时间",width:"250","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===e.tableData[t.$index].status?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.setFailReason(e.tableData[t.$index].failReason)}}},[e._v("\n          失败原因\n        ")]):e._e(),e._v(" "),2===e.tableData[t.$index].status&&void 0!==e.tableData[t.$index].elementId&&void 0!==e.tableData[t.$index].failStepId?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.getFailImg(e.tableData[t.$index].id,e.tableData[t.$index].status)}}},[e._v("\n          失败图片\n        ")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":function(t){return e.getResultList("nextPage")},"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[a("span",[e._v(e._s(e.pageSize)+"条/页")])]),e._v(" "),a("el-dialog",{attrs:{title:"失败原因",visible:e.failReasonVisible,width:"70%"},on:{"update:visible":function(t){e.failReasonVisible=t}}},[a("el-card",{staticClass:"box-card"},[a("span",[e._v(e._s(e.failReason))])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:""},on:{click:function(t){e.failReasonVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"失败图片",visible:e.failImgVisible,width:"90%"},on:{"update:visible":function(t){e.failImgVisible=t}}},[a("el-card",{staticClass:"box-card"},[a("el-image",{staticStyle:{width:"100%"},attrs:{src:e.imgSrc}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:""},on:{click:function(t){e.failImgVisible=!1}}},[e._v("关 闭")])],1)],1),e._v(" "),e.caseDialogVisible?a("web-ui-case-dialog",{attrs:{visible:e.caseDialogVisible,"case-id":e.caseId,type:e.caseDialogVisibleType},on:{listenToChildEvent:e.callbackFunc}}):e._e(),e._v(" "),e.stepDialogVisible?a("step-dialog",{attrs:{visible:e.stepDialogVisible,"step-id":e.stepId,type:e.stepDialogVisibleType},on:{listenToChildEvent:e.callbackFuncStep}}):e._e(),e._v(" "),e.elementDialogVisible?a("element-dialog",{attrs:{visible:e.elementDialogVisible,"element-id":e.elementId,type:e.elementDialogVisibleType},on:{listenToChildEvent:e.callbackFuncElement}}):e._e()],1)},staticRenderFns:[]};var f={name:"UiCaseResultPic",data:function(){return{pageList:[],searchForm:{pageId:"",caseIds:"",caseName:"",addTime:[]},resultChart:{credits:{enabled:!0,href:"http://www.thinkingdata.cn",text:"数数科技"},yAxis:{title:{text:"运行总数、成功、失败数（条）"}},title:{text:"运行状况混合图表"},xAxis:{categories:[]},labels:{},series:[]}}},methods:{getResultPic:function(){var e=this;this.initChart();var t=String.format("{0}/result/getResultPic",this.GLOBAL.WEBUI_URL);this.searchForm.pageNum=this.currentPage,this.axios.post(t,r()(this.searchForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){e.resultChart.xAxis.categories=t.data.data.categories,e.resultChart.series.push({type:"column",data:t.data.data.allColumn,name:"运行总数",color:"#B3D9D9"}),e.resultChart.series.push({type:"spline",data:t.data.data.successSpline,name:"成功数量",color:"#53FF53"}),e.resultChart.series.push({type:"spline",data:t.data.data.failSpline,name:"失败数量",color:"#ff7575"});var a={type:"pie",name:"百分比",tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.2f}%</b>"},data:[{name:"成功",y:t.data.data.successTotal,color:"#53FF53"},{name:"失败",y:t.data.data.failTotal,color:"#ff7575"}],center:[25,50],size:100,showInLegend:!1,dataLabels:{enabled:!1}},i={items:[{html:"成功、失败占比",style:{left:"0px",top:"5px",color:e.Highcharts.theme&&e.Highcharts.theme.textColor||"black"}}]};return t.data.data.successTotal+t.data.data.failTotal>0&&(e.resultChart.labels=i,e.resultChart.series.push(a)),e.Highcharts.chart("resultChart",e.resultChart),t}).catch(function(e){return e})},initChart:function(){this.resultChart={credits:{enabled:!0,href:"http://www.thinkingdata.cn",text:"数数科技"},yAxis:{title:{text:"运行总数、成功、失败数（条）"}},title:{text:"运行状况混合图表"},xAxis:{categories:[]},labels:{},series:[]}},reset:function(){this.searchForm.pageId="",this.searchForm.caseIds="",this.searchForm.caseName="";var e=this.formatDate(new Date),t=new Date;t.setTime(t.getTime()-5184e5),t=this.formatDate(t),this.searchForm.addTime=[t,e],this.getResultPic()},formatDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();return a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),t+"-"+a+"-"+i},getConditions:function(){var e=this,t=String.format("{0}/result/getSearchCondition",this.GLOBAL.WEBUI_URL);this.axios.get(t).then(function(t){return e.pageList=t.data.data.pageList,t}).catch(function(e){return e})}},beforeMount:function(){var e=this.formatDate(new Date),t=new Date;t.setTime(t.getTime()-5184e5),t=this.formatDate(t),this.searchForm.addTime=[t,e],this.getConditions()},mounted:function(){this.getResultPic()},watch:{"searchForm.addTime":{handler:function(e,t){if(""===e||null===e||e.length<2){var a=this.formatDate(new Date),i=new Date;i.setTime(i.getTime()-5184e5),i=this.formatDate(i),this.searchForm.addTime=[i,a]}},immediate:!0,deep:!0}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"所属业务"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.searchForm.pageId,callback:function(t){e.$set(e.searchForm,"pageId",t)},expression:"searchForm.pageId"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.pageName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用例id"}},[a("el-input",{attrs:{placeholder:"输入用例id,多个id以','分割",clearable:""},model:{value:e.searchForm.caseIds,callback:function(t){e.$set(e.searchForm,"caseIds",t)},expression:"searchForm.caseIds"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用例名称"}},[a("el-input",{attrs:{placeholder:"输入用例名称",clearable:""},model:{value:e.searchForm.caseName,callback:function(t){e.$set(e.searchForm,"caseName",t)},expression:"searchForm.caseName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"daterange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.addTime,callback:function(t){e.$set(e.searchForm,"addTime",t)},expression:"searchForm.addTime"}})],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right","margin-right":"60px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getResultPic()}}},[e._v("查询 ")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{attrs:{id:"resultChart"}})],1)},staticRenderFns:[]};var g={name:"UiCaseResult",components:{uiCaseResultList:a("VU/8")(d,m,!1,function(e){a("+8kM")},"data-v-592ad94d",null).exports,uiCaseResultPic:a("VU/8")(f,h,!1,function(e){a("4dgX")},"data-v-4489c9aa",null).exports},data:function(){return{activeName:"uiCaseResultPic"}},methods:{getUrlParam:function(){var e=this.$route.query,t={id:"",pageId:"",caseIds:"",caseName:"",status:"",addTime:[],pageNum:1};n()(e).length>0&&(t.addTime.push(e.startTime),t.addTime.push(e.endTime),t.status=""===e.status?e.status:s()(e.status),t.caseIds=e.caseIds,this.activeName="uiCaseResultList",this.$refs.uiCaseResultList.getConditions(),this.$refs.uiCaseResultList.getResultListByUrl(t))},switchTab:function(){"uiCaseResultList"===this.activeName?(this.$refs.uiCaseResultList.getConditions(),this.$refs.uiCaseResultList.getResultList("search")):"uiCaseResultPic"===this.activeName&&(this.$refs.uiCaseResultPic.getConditions(),this.$refs.uiCaseResultPic.getResultPic())}},mounted:function(){this.getUrlParam()}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.switchTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"uiCaseResultPic"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon"}),e._v("结果图表")]),e._v(" "),a("ui-case-result-pic",{ref:"uiCaseResultPic"})],1),e._v(" "),a("el-tab-pane",{attrs:{name:"uiCaseResultList"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),e._v("结果列表")]),e._v(" "),a("ui-case-result-list",{ref:"uiCaseResultList"})],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(g,b,!1,function(e){a("lDlj")},"data-v-8b1fcfbc",null);t.default=v.exports}});
//# sourceMappingURL=4.bbe9ffc1410706cc2025.js.map