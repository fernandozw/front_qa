webpackJsonp([14],{"8/P8":function(e,t){},kuL3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("gBtx"),s=a.n(i),l=a("mvHQ"),n=a.n(l),o=a("pFYg"),r=a.n(o),c={name:"ETLSceneDialog",props:{sceneId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{verifyTypeOptions:[{label:"默认校验",value:!1},{label:"自定义校验",value:!0}],sceneTypeOptions:[{label:"事件",value:1},{label:"用户属性",value:2}],allCaseList:[],addConfigDetail:{sceneName:"",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"'+this.getNowTime()+'"}',idList:"",version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3748",time:this.getCurrentDate(),waitTime:10,customCheck:!1,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3748\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3748\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',sceneType:""},configDetail:{},configRules:{url:[{required:!0,message:"上报地址不能为空"}],idList:[{required:!0,message:"用例列表不能为空"}],trinoMap:[{required:!0,message:"trino配置不能为空"}],projectId:[{required:!0,message:"项目ID不能为空"}],time:[{required:!0,message:"上报日期不能为空"}],sceneType:[{required:!0,message:"场景类型不能为空"}],waitTime:[{required:!0,message:"等待时长不能为空"}],sceneName:[{required:!0,message:"场景名称不能为空"}],valueMap:[{required:!0,message:"动态参数不能为空"}]}}},methods:{close:function(){this.$emit("listenToChildEvent",!1)},getNowTime:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())+"."+e.getMilliseconds()},isInt:function(e){return!!/^[1-9]+[0-9]*]*$/.test(e.value)},isJson:function(e){try{return"object"===r()(JSON.parse(e))}catch(e){return!1}},getCurrentDate:function(){var e=new Date,t={year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()};return t.year+"-"+(t.month>=10?t.month:"0"+t.month)+"-"+(t.date>=10?t.date:"0"+t.date)},detail:function(){var e=this,t=String.format("{0}/etlScene/detail?id={1}",this.GLOBAL.ETL_URL,this.sceneId);this.axios.get(t).then(function(t){var a=JSON.parse(n()(t.data.data));return a.idList=a.idList.split(",").map(Number),1===a.customCheck?a.customCheck=!0:a.customCheck=!1,e.configDetail=a,t}).catch(function(e){return e})},getAllCase:function(){var e=this,t=String.format("{0}/etlCase/allCase",this.GLOBAL.ETL_URL);this.axios.get(t).then(function(t){return e.allCaseList=t.data.data,t}).catch(function(e){return e})},executeScene:function(){var e=this;this.$refs.configDetail.validate(function(t){if(t){var a=String.format("{0}/etlCase/execute",e.GLOBAL.ETL_URL),i=JSON.parse(n()(e.configDetail));Array.isArray(i.sqlList)||(i.sqlList=i.sqlList.replace("\n","").split(",")),e.isJson(i.expectValueList)?i.expectValueList=JSON.parse(i.expectValueList):i.expectValueList=[],Array.isArray(i.idList)||(i.idList=i.idList.split(",").map(Number)),e.isJson(i.trinoMap)?i.trinoMap=JSON.parse(i.trinoMap):i.trinoMap={},e.isJson(i.valueMap)?i.valueMap=JSON.parse(i.valueMap):i.valueMap={},e.isInt(i.waitTime)||(i.waitTime=s()(i.waitTime)),e.axios.post(a,i,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return e.loading=!1,"1000"===t.data.code?e.Message.success(t.data.message):e.Message.error(t.data.message),t}).catch(function(e){return e})}else e.Message.error("请填写必填项!")})},saveScene:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=2===t.type?String.format("{0}/etlScene/update",t.GLOBAL.ETL_URL):String.format("{0}/etlScene/add",t.GLOBAL.ETL_URL),i=JSON.parse(n()(t.configDetail));i.customCheck=i.customCheck?1:2,i.idList=i.idList.join(","),t.axios.post(a,i,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.message),t.dialogVisible=!1,t.$emit("listenToChildEvent",!0)):t.Message.error(e.data.message),e}).catch(function(e){return e})}else t.Message.error("请填写必填项!")})}},computed:{dialogTitle:function(){return 2===this.type?"编辑（场景ID："+this.sceneId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){this.getAllCase(),this.dialogVisible=this.visible,2===this.type||3===this.type?this.detail():1===this.type&&(this.configDetail=this.addConfigDetail)}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"configDetail",attrs:{inline:!0,model:e.configDetail,size:"mini",rules:e.configRules}},[a("el-row",{attrs:{gutter:20}},[a("el-form-item",{attrs:{label:"场景名称",prop:"sceneName"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"必填项",clearable:""},model:{value:e.configDetail.sceneName,callback:function(t){e.$set(e.configDetail,"sceneName",t)},expression:"configDetail.sceneName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上报地址",prop:"url"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"必填项:http://39.100.208.209:8991/sync_json",clearable:""},model:{value:e.configDetail.url,callback:function(t){e.$set(e.configDetail,"url",t)},expression:"configDetail.url"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-form-item",{attrs:{label:"动态参数                                                                ",prop:"valueMap"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'请输入内容:{"data.#time":"2023-04-26 00:00:00.567","#event_name":"测试事件名称","properties.batchNo":"2023-04-26 00:00:00"}',clearable:""},model:{value:e.configDetail.valueMap,callback:function(t){e.$set(e.configDetail,"valueMap",t)},expression:"configDetail.valueMap"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"trino配置",prop:"trinoMap"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'必填项:{"url":"jdbc:trino://192.168.0.106:8080","user":"ta","password":"","SSL":"false"}',clearable:""},model:{value:e.configDetail.trinoMap,callback:function(t){e.$set(e.configDetail,"trinoMap",t)},expression:"configDetail.trinoMap"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-form-item",{staticClass:"idListForm",attrs:{label:"用例列表",prop:"idList"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticClass:"idListSelect",staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"必填项:请选择",filterable:""},model:{value:e.configDetail.idList,callback:function(t){e.$set(e.configDetail,"idList",t)},expression:"configDetail.idList"}},e._l(e.allCaseList,function(e){return a("el-option",{key:e.id,attrs:{label:"["+(1===e.caseType?"事件":"用户属性")+"]["+e.id+"]"+e.caseName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"verifyForm",staticStyle:{"margin-left":"20px"},attrs:{label:"场景类型",prop:"sceneType"}},[a("el-col",{attrs:{span:4}},[a("el-select",{staticClass:"verifySelect",attrs:{placeholder:"必填项:请选择",clearable:""},model:{value:e.configDetail.sceneType,callback:function(t){e.$set(e.configDetail,"sceneType",t)},expression:"configDetail.sceneType"}},e._l(e.sceneTypeOptions,function(e){return a("el-option",{key:e.index,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"verifyForm",attrs:{label:"校验方式",prop:"customCheck"}},[a("el-col",{attrs:{span:8}},[a("el-select",{staticClass:"verifySelect",attrs:{placeholder:"必填项:请选择",clearable:""},model:{value:e.configDetail.customCheck,callback:function(t){e.$set(e.configDetail,"customCheck",t)},expression:"configDetail.customCheck"}},e._l(e.verifyTypeOptions,function(e){return a("el-option",{key:e.index,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[e.configDetail.customCheck?a("el-form-item",{attrs:{label:"自定义SQL",prop:"sqlList"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"多条SQL请用',分割,结尾不要用';',查询结果是一个二维数组,如果是聚合查询,查询列必须有别名,请确保SQL语法正确,不要删除batchNo和uuid字段",clearable:""},model:{value:e.configDetail.sqlList,callback:function(t){e.$set(e.configDetail,"sqlList",t)},expression:"configDetail.sqlList"}})],1)],1):e._e(),e._v(" "),e.configDetail.customCheck?a("el-form-item",{attrs:{label:"自定义期望结果",prop:"valueMap"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'自定义期望结果是一个二维数组,格式如下[[{"nameCount":1,"avgCount":10}],[{"ageCount":2}]]',clearable:""},model:{value:e.configDetail.expectValueList,callback:function(t){e.$set(e.configDetail,"expectValueList",t)},expression:"configDetail.expectValueList"}})],1)],1):e._e()],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-form-item",{attrs:{label:"等待时长(分钟)",prop:"waitTime"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"input",placeholder:"请输入内容",clearable:""},model:{value:e.configDetail.waitTime,callback:function(t){e.$set(e.configDetail,"waitTime",t)},expression:"configDetail.waitTime"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"主版本",prop:"version"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"input",placeholder:"请输入内容",clearable:""},model:{value:e.configDetail.version,callback:function(t){e.$set(e.configDetail,"version",t)},expression:"configDetail.version"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"子版本",prop:"subVersion"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"input",placeholder:"请输入内容",clearable:""},model:{value:e.configDetail.subVersion,callback:function(t){e.$set(e.configDetail,"subVersion",t)},expression:"configDetail.subVersion"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目ID",prop:"projectId"}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{type:"input",placeholder:"必填项:请输入项目ID",clearable:""},model:{value:e.configDetail.projectId,callback:function(t){e.$set(e.configDetail,"projectId",t)},expression:"configDetail.projectId"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上报日期",prop:"time"}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{type:"input",placeholder:"必填项:请输入上报日期",clearable:""},model:{value:e.configDetail.time,callback:function(t){e.$set(e.configDetail,"time",t)},expression:"configDetail.time"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.executeScene}},[e._v("执 行\n      ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveScene("configDetail")}}},[e._v("保 存")])],1)])],1)},staticRenderFns:[]};var p={name:"ETLSceneList",components:{etlSceneDialog:a("VU/8")(c,u,!1,function(e){a("8/P8")},"data-v-6e261302",null).exports},data:function(){return{loading:!1,allCaseList:[],sceneTypeOptions:[{label:"事件",value:1},{label:"用户属性",value:2}],pageSize:10,total:0,pageNum:1,sceneId:null,dialogVisibleType:1,dialogVisible:!1,searchForm:{id:"",sceneName:"",sceneType:"",url:"",version:"",subVersion:"",addTime:"",updateTime:""},tableData:[],batchExecuteDialog:!1,sceneIdList:[],sceneList:[{id:6,sceneName:"朱伟的自定义场景模板",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-05-17 12:38:34.241"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-05-17",waitTime:5,awaitTime:0,customCheck:1,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":1}]]',idList:"43,41",sceneType:1,tableMetaType:null,creator:null,addTime:"2023-05-17 12:39:37",updateTime:"2023-05-17 16:21:22"},{id:7,sceneName:"朱伟的自定义场景模板1",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-05-17 12:38:34.241"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-05-17",waitTime:5,awaitTime:0,customCheck:1,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"43,41",sceneType:1,tableMetaType:null,creator:null,addTime:"2023-05-17 14:03:40",updateTime:"2023-05-17 14:11:22"},{id:8,sceneName:"zhuweitest3",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"7ec5cbba58114551b47956f6118e03d9","data.#time":"2023-07-07 09:26:11.458"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-05-17",waitTime:10,awaitTime:0,customCheck:2,sqlList:" select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count2":1}]]',idList:"43",sceneType:1,tableMetaType:null,creator:null,addTime:"2023-05-17 15:34:26",updateTime:"2023-05-17 15:34:26"},{id:9,sceneName:"黄鹤的自定义场景",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"7ec5cbba58114551b47956f6118e03d9","data.#time":"2023-07-07 09:26:11.458"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3748",time:"2023-07-07",waitTime:2,awaitTime:0,customCheck:1,sqlList:"select count(*) as count1 FROM hive.ta.\"v_event_3748\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}]]',idList:"9",sceneType:1,tableMetaType:"1",creator:null,addTime:"2023-05-17 16:23:23",updateTime:"2023-05-17 16:23:23"},{id:10,sceneName:"复杂数据类型",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"7ec5cbba58114551b47956f6118e03d9","data.#time":"2023-07-07 09:26:11.458"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3748",time:"2023-07-07",waitTime:2,awaitTime:0,customCheck:1,sqlList:" select count(*) as count2 FROM hive.ta.\"v_user_3748\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count2":1}]]',idList:"10",sceneType:1,tableMetaType:"2",creator:null,addTime:"2023-05-17 16:26:25",updateTime:"2023-05-17 16:27:49"},{id:11,sceneName:"演示",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-05-17 17:00:55.616"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3748",time:"2023-05-17",waitTime:10,awaitTime:0,customCheck:2,sqlList:" select count(*) as count2 FROM hive.ta.\"v_event_3748\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"9,45,44,43,42,41",sceneType:1,tableMetaType:null,creator:null,addTime:"2023-05-17 17:01:29",updateTime:"2023-05-17 17:01:29"},{id:12,sceneName:"全选场景",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-05-17 17:04:47.436"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-05-17",waitTime:5,awaitTime:0,customCheck:2,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3748\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3748\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"9,10,27,28,29,30,31,32,33,35,36,37,39,41,42,43,44,45",sceneType:1,tableMetaType:null,creator:null,addTime:"2023-05-17 17:07:00",updateTime:"2023-05-19 16:46:20"},{id:19,sceneName:"track",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-06-01 16:57:53.651"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-06-01",waitTime:5,awaitTime:0,customCheck:2,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"44",sceneType:1,tableMetaType:null,creator:"朱伟",addTime:"2023-06-01 16:59:32",updateTime:"2023-06-01 16:59:32"},{id:20,sceneName:"track_update",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"7ec5cbba58114551b47956f6118e03d9","data.#time":"2023-06-28 13:59:37.516"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3748",time:"2023-06-28",waitTime:5,awaitTime:0,customCheck:2,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"10",sceneType:2,tableMetaType:"qweads",creator:"朱伟",addTime:"2023-06-01 16:59:58",updateTime:"2023-06-28 17:06:01"},{id:21,sceneName:"track_overwrite",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-06-01 16:59:59.725"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-06-01",waitTime:5,awaitTime:0,customCheck:1,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"27",sceneType:1,tableMetaType:null,creator:"朱伟",addTime:"2023-06-01 17:00:23",updateTime:"2023-06-01 17:00:23"},{id:22,sceneName:"1231",url:"http://39.100.208.209:8991/sync_json",valueMap:'{"appid":"69b2de81e39d4528a06f62cccf280af5","data.#time":"2023-06-01 17:16:36.181"}',version:"4.0",subVersion:"4.0.1",trinoMap:'{"url": "jdbc:trino://39.100.208.209:8080","user": "ta","password": "","SSL": "false"}',projectId:"3800",time:"2023-06-01",waitTime:5,awaitTime:1,customCheck:2,sqlList:"select count(*) as count1 FROM hive.ta.\"v_user_3800\" t where batchNo='%s' and uuid not in (%s),\n select count(*) as count2 FROM hive.ta.\"v_event_3800\" t where batchNo='%s' and uuid not in (%s)",expectValueList:'[[{"count1":1}],[{"count2":2}]]',idList:"31",sceneType:1,tableMetaType:null,creator:"朱伟",addTime:"2023-06-01 17:16:50",updateTime:"2023-06-02 10:49:55"}]}},methods:{tableRowClassName:function(e){e.row;return e.rowIndex%2==0?"warning-row":"success-row"},callbackFunc:function(e){this.dialogVisible=!1,e&&this.getSceneList("search")},reSet:function(){this.pageNum=1,this.searchForm={id:"",sceneName:"",sceneType:"",url:"",version:"",subVersion:"",addTime:"",updateTime:""},this.getSceneList("search")},isInt:function(e){return!!/^[1-9]+[0-9]*]*$/.test(e.value)},isJson:function(e){try{return"object"===r()(JSON.parse(e))}catch(e){return!1}},closeBatchExecuteDialog:function(){console.log(this.sceneIdList),this.batchExecuteDialog=!1,this.sceneIdList=[]},executeScene:function(e){var t=this,a=String.format("{0}/etlCase/execute",this.GLOBAL.ETL_URL),i=JSON.parse(n()(e));Array.isArray(i.sqlList)||(i.sqlList=i.sqlList.replace("\n","").split(",")),this.isJson(i.expectValueList)?i.expectValueList=JSON.parse(i.expectValueList):i.expectValueList=[],Array.isArray(i.idList)||(i.idList=i.idList.split(",").map(Number)),this.isJson(i.trinoMap)?i.trinoMap=JSON.parse(i.trinoMap):i.trinoMap={},this.isJson(i.valueMap)?i.valueMap=JSON.parse(i.valueMap):i.valueMap={},this.isInt(i.waitTime)||(i.waitTime=s()(i.waitTime)),i.customCheck=1===i.customCheck,this.axios.post(a,i,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return t.loading=!1,"1000"===e.data.code?t.Message.success(e.data.message):t.Message.error(e.data.message),e}).catch(function(e){return e})},sceneDetail:function(e,t){"edit"===t?this.dialogVisibleType=2:"copy"===t&&(this.dialogVisibleType=3),this.sceneId=e,this.dialogVisible=!0},getSceneList:function(e){var t=this;"search"===e&&(this.pageNum=1);var a=String.format("{0}/etlScene/list",this.GLOBAL.ETL_URL);this.searchForm.pageNum=this.pageNum,this.axios.post(a,this.searchForm,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return t.total=e.data.data.total,t.tableData=e.data.data.apiEtlSceneList,e}).catch(function(e){return e})},deleteScene:function(e){var t=this;this.$confirm(String.format("此操作将永久删除该场景(id:{0}), 是否继续?",e),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=String.format("{0}/etlScene/delete",t.GLOBAL.ETL_URL),i={id:e};t.axios.post(a,i,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.message),t.getSceneList("search")):t.Message.error(e.data.message),e}).catch(function(e){return e})})},clickAddBtn:function(){this.dialogVisibleType=1,this.dialogVisible=!0}},beforeMount:function(){this.getSceneList()}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"10px"},attrs:{shadow:"always","element-loading-text":"执行中,上报后会等待10秒,请稍等～～～～～","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"场景id"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入场景id",clearable:""},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"场景名称"}},[a("el-input",{attrs:{placeholder:"输入场景名称",clearable:""},model:{value:e.searchForm.sceneName,callback:function(t){e.$set(e.searchForm,"sceneName",t)},expression:"searchForm.sceneName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"场景类型"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.searchForm.sceneType,callback:function(t){e.$set(e.searchForm,"sceneType",t)},expression:"searchForm.sceneType"}},e._l(e.sceneTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上报地址"}},[a("el-input",{attrs:{placeholder:"输入上报地址",clearable:""},model:{value:e.searchForm.url,callback:function(t){e.$set(e.searchForm,"url",t)},expression:"searchForm.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主版本"}},[a("el-input",{attrs:{placeholder:"输入主版本",clearable:""},model:{value:e.searchForm.version,callback:function(t){e.$set(e.searchForm,"version",t)},expression:"searchForm.version"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"子版本"}},[a("el-input",{attrs:{placeholder:"输入子版本",clearable:""},model:{value:e.searchForm.subVersion,callback:function(t){e.$set(e.searchForm,"subVersion",t)},expression:"searchForm.subVersion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchForm.addTime,callback:function(t){e.$set(e.searchForm,"addTime",t)},expression:"searchForm.addTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"更新时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchForm.updateTime,callback:function(t){e.$set(e.searchForm,"updateTime",t)},expression:"searchForm.updateTime"}})],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right","margin-right":"60px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getSceneList("search")}}},[e._v("查 询\n        ")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.clickAddBtn}},[e._v("新 增")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.batchExecuteDialog=!0}}},[e._v("批量执行")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.reSet}},[e._v("重 置")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"mini",align:"center"}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"id",label:"场景id",width:"100",align:"center",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"sceneName",label:"场景名称",width:"250",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"sceneType",label:"场景类型",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===e.tableData[t.$index].sceneType?a("span",[e._v("事件")]):2===e.tableData[t.$index].sceneType?a("span",[e._v("用户属性")]):a("span",[e._v("未知")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"idList",label:"用例集",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"url",label:"上报地址",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"valueMap",label:"动态参数",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"version",label:"主版本",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"subVersion",label:"子版本",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"trinoMap",label:"trino配置",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"projectId",label:"项目Id",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"time",label:"上报日期",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"waitTime",label:"等待时长",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"customCheck",label:"自定义校验",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===e.tableData[t.$index].customCheck?a("span",[e._v("开启")]):2===e.tableData[t.$index].customCheck?a("span",[e._v("关闭")]):a("span",[e._v("未知")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"sqlList",label:"自定义校验SQL",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"expectValueList",label:"自定义校验期望值",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"addTime",label:"创建时间",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"addTime",label:"更新时间",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",label:"操作",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.executeScene(e.tableData[t.$index])}}},[e._v("执行\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.sceneDetail(e.tableData[t.$index].id,"copy")}}},[e._v("复制\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.sceneDetail(e.tableData[t.$index].id,"edit")}}},[e._v("编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.deleteScene(e.tableData[t.$index].id)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.pageNum,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":function(t){return e.getSceneList()},"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}},[a("span",[e._v(e._s(e.pageSize)+"条/页")])])],1),e._v(" "),e.dialogVisible?a("etl-scene-dialog",{attrs:{visible:e.dialogVisible,"scene-id":e.sceneId,type:e.dialogVisibleType},on:{listenToChildEvent:e.callbackFunc}}):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"批量执行场景",visible:e.batchExecuteDialog,width:"60%"},on:{"update:visible":function(t){e.batchExecuteDialog=t},close:e.closeBatchExecuteDialog}},[a("div",[a("el-card",{staticClass:"box-card"},[a("el-select",{staticStyle:{"margin-left":"20px",width:"600px"},attrs:{multiple:"",placeholder:"请选择",clearable:""},model:{value:e.sceneIdList,callback:function(t){e.sceneIdList=t},expression:"sceneIdList"}},e._l(e.sceneList,function(e){return a("el-option",{key:e.id,attrs:{label:e.sceneName,value:e.id}})}),1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger",size:"mini"}},[e._v("执 行 ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.closeBatchExecuteDialog}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(p,d,!1,function(e){a("waye")},"data-v-22bb972e",null);t.default=m.exports},waye:function(e,t){}});
//# sourceMappingURL=14.25ff478bbb46b9fc1bde.js.map