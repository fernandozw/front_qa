webpackJsonp([18],{AC7E:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("mvHQ"),i=a.n(l),s={name:"ETLBatchCaseDialog",props:{batchCaseId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{dialogVisible:!1,allSceneList:[],createOptions:[{label:"是",value:1},{label:"否",value:2}],batchCaseDetail:{id:"",batchCaseName:"",sceneIdList:[],createProject:2,loginMap:"",trinoMap:"",etlUrl:"",debugUrl:"",projectId:"",appId:"",creator:""},rules:{batchCaseName:[{required:!0,message:"批量场景名称不能为空"}],createProject:[{required:!0,message:"是否创建项目不能为空"}],sceneIdList:[{required:!0,message:"场景id列表不能为空"}],trinoMap:[{required:!0,message:"trino配置不能为空"}],etlUrl:[{required:!0,message:"数据上报地址不能为空"}],debugUrl:[{required:!0,message:"debug接口地址不能为空"}]}}},methods:{close:function(){this.$emit("listenToChildEvent",!1)},saveBatchCase:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=2===t.type?"{0}/etlBatchCase/update":"{0}/etlBatchCase/add",l=String.format(a,t.GLOBAL.ETL_URL);1===t.type&&(t.batchCaseDetail.creator=localStorage.getItem("executor"));var s=JSON.parse(i()(t.batchCaseDetail));s.sceneIdList=s.sceneIdList.join(","),t.axios.post(l,s,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.message),t.dialogVisible=!1,t.$emit("listenToChildEvent",!0)):t.Message.error(e.data.message),e}).catch(function(e){return e})}})},getAllScene:function(){var e=this,t=String.format("{0}/etlScene/allScene",this.GLOBAL.ETL_URL);this.axios.get(t).then(function(t){return e.allSceneList=t.data.data,t}).catch(function(e){return e})},detail:function(){var e=this,t=String.format("{0}/etlBatchCase/detail?id={1}",this.GLOBAL.ETL_URL,this.batchCaseId);this.axios.get(t).then(function(t){return e.batchCaseDetail=t.data.data,e.batchCaseDetail.sceneIdList=e.batchCaseDetail.sceneIdList.split(","),t}).catch(function(e){return e})}},computed:{dialogTitle:function(){return 2===this.type?"编辑（批量场景ID："+this.batchCaseId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){localStorage.setItem("executor","朱伟"),this.dialogVisible=this.visible,this.getAllScene(),2!==this.type&&3!==this.type||this.detail()}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"case-dialog",attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"batchCaseDetail",attrs:{inline:!0,model:e.batchCaseDetail,size:"mini",rules:e.rules}},[a("el-row",{attrs:{gutter:20}},[a("el-form-item",{attrs:{label:"批量场景名称",prop:"batchCaseName"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"必填项",clearable:""},model:{value:e.batchCaseDetail.batchCaseName,callback:function(t){e.$set(e.batchCaseDetail,"batchCaseName",t)},expression:"batchCaseDetail.batchCaseName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否创建项目",prop:"createProject"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticClass:"createSelect",attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.batchCaseDetail.createProject,callback:function(t){e.$set(e.batchCaseDetail,"createProject",t)},expression:"batchCaseDetail.createProject"}},e._l(e.createOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[1===e.batchCaseDetail.createProject?a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"项目登录信息",prop:"loginMap"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'仅在需要创建项目时填写,格式为json:{"host":"http://192.168.0.14:8993","loginName":"root","enPassword":"hxYFpJgC8iain5YQvsGP3Dm/T/SjP0R9gNalWR0hjghcRyO11tpS47ixbUKwJqjMhUMJ7FWEnaBpnn3GJ6KKH5viD0sAK7fpgzcm0lrEpTXcV3FKQcAsX+g/Qwsn2P6BFqmDP8ipI3GHKa/UcWxZTW4y5VZWDeS09PYsdBIGKd0="}',clearable:""},model:{value:e.batchCaseDetail.loginMap,callback:function(t){e.$set(e.batchCaseDetail,"loginMap",t)},expression:"batchCaseDetail.loginMap"}})],1)],1):e._e(),e._v(" "),a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"trino配置信息",prop:"trinoMap"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'必填项,格式为json:{"url": "jdbc:trino://192.168.0.14:8080","user": "ta","password": "","SSL": "false"}',clearable:""},model:{value:e.batchCaseDetail.trinoMap,callback:function(t){e.$set(e.batchCaseDetail,"trinoMap",t)},expression:"batchCaseDetail.trinoMap"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[2===e.batchCaseDetail.createProject?a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"项目id",prop:"projectId"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"input",placeholder:"仅在不需要创建项目时填写,需要创建项目时会默认使用创建后的项目id。",clearable:""},model:{value:e.batchCaseDetail.projectId,callback:function(t){e.$set(e.batchCaseDetail,"projectId",t)},expression:"batchCaseDetail.projectId"}})],1)],1):e._e(),e._v(" "),2===e.batchCaseDetail.createProject?a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"appid",prop:"appId"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"input",placeholder:"仅在不需要创建项目时填写,需要创建项目时会默认使用创建后的appid。",clearable:""},model:{value:e.batchCaseDetail.appId,callback:function(t){e.$set(e.batchCaseDetail,"appId",t)},expression:"batchCaseDetail.appId"}})],1)],1):e._e()],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"数据上报地址",prop:"etlUrl"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"input",placeholder:"必填项:http://192.168.0.14:8991/sync_json",clearable:""},model:{value:e.batchCaseDetail.etlUrl,callback:function(t){e.$set(e.batchCaseDetail,"etlUrl",t)},expression:"batchCaseDetail.etlUrl"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"数据debug地址",prop:"debugUrl"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{type:"input",placeholder:"必填项:http://192.168.0.14:8995/data_debug",clearable:""},model:{value:e.batchCaseDetail.debugUrl,callback:function(t){e.$set(e.batchCaseDetail,"debugUrl",t)},expression:"batchCaseDetail.debugUrl"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-form-item",{attrs:{label:"执行场景列表",prop:"sceneIdList"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticClass:"sceneIdListSelect",staticStyle:{"margin-left":"20px"},attrs:{filterable:"",placeholder:"请选择",clearable:"",multiple:"","collapse-tags":""},model:{value:e.batchCaseDetail.sceneIdList,callback:function(t){e.$set(e.batchCaseDetail,"sceneIdList",t)},expression:"batchCaseDetail.sceneIdList"}},e._l(e.allSceneList,function(e){return a("el-option",{key:e.id,attrs:{label:"「"+e.id+"」"+e.sceneName,value:e.id+""}})}),1)],1)],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveBatchCase("batchCaseDetail")}}},[e._v("\n      "+e._s(e.btnText)+"\n    ")])],1)])},staticRenderFns:[]};var c={name:"ETLBatchCaseList",components:{etlBatchCaseDialog:a("VU/8")(s,r,!1,function(e){a("ZMLp")},"data-v-95c97900",null).exports},data:function(){return{loading:!1,pageSize:10,total:0,batchCaseId:null,pageNum:1,caseId:null,dialogVisibleType:1,dialogVisible:!1,searchForm:{id:"",batchCaseName:"",creator:null,addTime:"",updateTime:""},tableData:[]}},methods:{callbackFunc:function(e){this.dialogVisible=!1,e&&this.getBatchCaseList("search")},reSet:function(){this.pageNum=1,this.searchForm={id:"",batchCaseName:"",creator:null,addTime:"",updateTime:""},this.getBatchCaseList("search")},batchCaseDetail:function(e,t){"edit"===t?this.dialogVisibleType=2:"copy"===t&&(this.dialogVisibleType=3),this.batchCaseId=e,this.dialogVisible=!0},getBatchCaseList:function(e){var t=this;"search"===e&&(this.pageNum=1);var a=String.format("{0}/etlBatchCase/list",this.GLOBAL.ETL_URL);this.searchForm.pageNum=this.pageNum,this.axios.post(a,this.searchForm,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return t.total=e.data.data.total,t.tableData=e.data.data.apiEtlBatchCaseList,e}).catch(function(e){return e})},deleteBatchCase:function(e){var t=this;this.$confirm(String.format("此操作将永久删除该批量场景(id:{0}), 是否继续?",e),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=String.format("{0}/etlBatchCase/delete",t.GLOBAL.ETL_URL),l={id:e};t.axios.post(a,l,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.message),t.getBatchCaseList("search")):t.Message.error(e.data.message),e}).catch(function(e){return e})})},executeBatchCase:function(e){var t=this;this.loading=!0;var a=String.format("{0}/etlBatchCase/execute?id={1}&executor={2}",this.GLOBAL.ETL_URL,e,localStorage.getItem("executor"));this.axios.get(a).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.message),t.loading=!1):(t.Message.error(e.data.message),t.loading=!1),e}).catch(function(e){return e})},clickAddBtn:function(){this.dialogVisibleType=1,this.dialogVisible=!0}},beforeMount:function(){this.getBatchCaseList()}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"10px"},attrs:{shadow:"always","element-loading-text":"执行中,上报后会等待10秒,请稍等～～～～～","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-form",{attrs:{inline:!0,model:e.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"批量场景id"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入批量场景id",clearable:""},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"批量场景名称"}},[a("el-input",{attrs:{placeholder:"输入批量场景名称",clearable:""},model:{value:e.searchForm.batchCaseName,callback:function(t){e.$set(e.searchForm,"batchCaseName",t)},expression:"searchForm.batchCaseName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{placeholder:"输入创建人",clearable:""},model:{value:e.searchForm.creator,callback:function(t){e.$set(e.searchForm,"creator",t)},expression:"searchForm.creator"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchForm.addTime,callback:function(t){e.$set(e.searchForm,"addTime",t)},expression:"searchForm.addTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"更新时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchForm.updateTime,callback:function(t){e.$set(e.searchForm,"updateTime",t)},expression:"searchForm.updateTime"}})],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right","margin-right":"60px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getBatchCaseList("search")}}},[e._v("查 询\n        ")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.clickAddBtn}},[e._v("新 增")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.reSet}},[e._v("重 置")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"mini",align:"center"}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"id",label:"批量场景id",width:"100",align:"center",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"batchCaseName",label:"批量场景名称",width:"250",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"sceneIdList",label:"场景集",align:"center",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"createProject",label:"是否创建项目",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===e.tableData[t.$index].createProject?a("span",[e._v("是")]):2===e.tableData[t.$index].createProject?a("span",[e._v("否")]):a("span",[e._v("未知")])]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"creator",label:"创建人",align:"center",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"addTime",label:"创建时间",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"addTime",label:"更新时间",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",label:"操作",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.executeBatchCase(e.tableData[t.$index].id)}}},[e._v("执行\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.batchCaseDetail(e.tableData[t.$index].id,"copy")}}},[e._v("复制\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.batchCaseDetail(e.tableData[t.$index].id,"edit")}}},[e._v("编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.deleteBatchCase(e.tableData[t.$index].id)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.pageNum,"page-size":e.pageSize,layout:"total,slot, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":function(t){return e.getBatchCaseList()},"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}},[a("span",[e._v(e._s(e.pageSize)+"条/页")])])],1),e._v(" "),e.dialogVisible?a("etl-batch-case-dialog",{attrs:{visible:e.dialogVisible,"batch-case-id":e.batchCaseId,type:e.dialogVisibleType},on:{listenToChildEvent:e.callbackFunc}}):e._e()],1)},staticRenderFns:[]};var n=a("VU/8")(c,o,!1,function(e){a("LaEm")},"data-v-8c4597a8",null);t.default=n.exports},LaEm:function(e,t){},ZMLp:function(e,t){}});
//# sourceMappingURL=18.ab8ee8d62cc81622375e.js.map