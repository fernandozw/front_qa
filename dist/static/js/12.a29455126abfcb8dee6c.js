webpackJsonp([12],{jpEp:function(t,e){},uAuy:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),r={name:"cronDialog",props:{cronId:{type:Number,default:null},type:{type:Number,default:1},visible:{type:Boolean,default:!0}},data:function(){return{dialogVisible:!0,cronDetail:{cornName:"",execTime:"",args:[],status:""},statusList:[],pageAndCaseOptions:[]}},methods:{saveCron:function(){var t=this,e=String.format(2===this.type?"{0}/cron/updateCron":"{0}/cron/addCron",this.GLOBAL.WEBUI_URL);this.cronDetail.args=this.cronDetail.args.join(","),this.axios.post(e,n()(this.cronDetail),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){return"1000"===e.data.code?(t.Message.success(e.data.msg),t.$emit("listenToChildEvent",!0)):t.Message.error(e.data.msg),e}).catch(function(t){return t})},close:function(){this.$emit("listenToChildEvent",!1)},getConditions:function(){var t=this,e=String.format("{0}/cron/getCondition",this.GLOBAL.WEBUI_URL);this.axios.get(e).then(function(e){return t.statusList=e.data.data.statusList,e}).catch(function(t){return t})},getPageAndCase:function(){var t=this,e=String.format("{0}/case/getPageAndCase",this.GLOBAL.WEBUI_URL);this.axios.get(e).then(function(e){return t.pageAndCaseOptions=e.data.data,e}).catch(function(t){return t})},detail:function(){var t=this;this.getPageAndCase(),this.getConditions();var e=String.format("{0}/cron/getCronById?id={1}",this.GLOBAL.WEBUI_URL,this.cronId);this.axios.get(e).then(function(e){var a=[];return e.data.data.args.split(",").forEach(function(t){a.push(+t)}),e.data.data.args=a,t.cronDetail=e.data.data,e}).catch(function(t){return t})}},computed:{dialogTitle:function(){return 2===this.type?"编辑（任务ID："+this.cronId+"）":3===this.type?"复制":"新增"},btnText:function(){return 3===this.type?"复 制":"保 存"},typeText:function(){return 2===this.type?"编辑":3===this.type?"复制":"新增"}},created:function(){this.dialogVisible=this.visible,1===this.type?(this.getConditions(),this.getPageAndCase()):2!==this.type&&3!==this.type||this.detail()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"element-dialog",attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"80%",id:"elementDialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{inline:!0,model:t.cronDetail,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务名称:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"必填项:请输入任务名称",clearable:""},model:{value:t.cronDetail.cronName,callback:function(e){t.$set(t.cronDetail,"cronName",e)},expression:"cronDetail.cronName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用例集合:"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{size:"mini",placeholder:"请选择用例",multiple:"",filterable:""},model:{value:t.cronDetail.args,callback:function(e){t.$set(t.cronDetail,"args",e)},expression:"cronDetail.args"}},t._l(t.pageAndCaseOptions,function(e){return a("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(t){return a("el-option",{key:t.value,attrs:{label:"「"+t.value+"」"+t.label,value:t.value}})}),1)}),1)],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"调度时间:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"必填项:请输入内容",clearable:""},model:{value:t.cronDetail.execTime,callback:function(e){t.$set(t.cronDetail,"execTime",e)},expression:"cronDetail.execTime"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"运行状态:"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择运行状态",clearable:""},model:{value:t.cronDetail.status,callback:function(e){t.$set(t.cronDetail,"status",e)},expression:"cronDetail.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:t.close}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.saveCron}},[t._v("\n        "+t._s(t.btnText)+"\n      ")])],1)])],1)},staticRenderFns:[]};var o={name:"WebUiTask",components:{cronDialog:a("VU/8")(r,s,!1,function(t){a("zyha")},"data-v-1dd55664",null).exports},data:function(){return{dialogVisible:!1,dialogVisibleType:1,cronId:null,tableData:[],currentPage:1,pageSize:10,total:0,statusList:[],statusMap:{},searchForm:{id:"",cronName:"",status:"",startTime:[],updateTime:[]}}},methods:{execCases:function(t){var e=this,a=String.format("{0}/case/execCaseList",this.GLOBAL.WEBUI_URL),i={caseIds:t};this.axios.post(a,n()(i),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return e.Message.success(t.data.msg),t}).catch(function(t){return t})},getCondition:function(){var t=this,e=String.format("{0}/cron/getCondition",this.GLOBAL.WEBUI_URL);this.axios.get(e).then(function(e){return t.statusList=e.data.data.statusList,t.statusMap=e.data.data.statusMap,e}).catch(function(t){return t})},resetSearchForm:function(){this.searchForm={id:"",cronName:"",status:"",startTime:[],updateTime:[]}},getCronList:function(t){var e=this;"reset"===t?(this.currentPage=1,this.resetSearchForm()):"normal"===t&&(this.currentPage=1);var a=String.format("{0}/cron/cronList",this.GLOBAL.WEBUI_URL);this.searchForm.pageNum=this.currentPage,this.axios.post(a,n()(this.searchForm),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return e.tableData=t.data.data.cronList,e.total=t.data.data.total,t}).catch(function(t){return t})},tableRowClassName:function(t){t.row;return t.rowIndex%2==0?"warning-row":"success-row"},callbackFunc:function(t){this.dialogVisible=!1,t&&this.getCronList("normal")},clickAddBtn:function(){this.dialogVisibleType=1,this.dialogVisible=!0},cronDetail:function(t,e){"edit"===e?this.dialogVisibleType=2:"copy"===e&&(this.dialogVisibleType=3),this.cronId=t,this.dialogVisible=!0},deleteCron:function(t){var e=this;this.$confirm(String.format("此操作将永久删除该任务(id:{0}), 是否继续?",t),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=String.format("{0}/cron/deleteCron",e.GLOBAL.WEBUI_URL),i={id:t};e.axios.post(a,n()(i),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){return"1000"===t.data.code?(e.Message.success(t.data.msg),e.getCronList("normal")):(e.Message.error(t.data.msg),e.getCronList("normal")),t}).catch(function(t){return t})})}},beforeMount:function(){this.getCondition(),this.getCronList()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{attrs:{inline:!0,model:t.searchForm,size:"mini"}},[a("el-form-item",{attrs:{label:"id"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"输入id",clearable:""},model:{value:t.searchForm.id,callback:function(e){t.$set(t.searchForm,"id",e)},expression:"searchForm.id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{placeholder:"输入任务名称",clearable:""},model:{value:t.searchForm.cronName,callback:function(e){t.$set(t.searchForm,"cronName",e)},expression:"searchForm.cronName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"运行状态"}},[a("el-select",{attrs:{filterable:"",placeholder:"选择运行状态",clearable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.searchForm.startTime,callback:function(e){t.$set(t.searchForm,"startTime",e)},expression:"searchForm.startTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"更新时间"}},[a("el-date-picker",{staticStyle:{width:"360px"},attrs:{type:"datetimerange",align:"right","start-placeholder":"起始时间","end-placeholder":"截止时间","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.searchForm.updateTime,callback:function(e){t.$set(t.searchForm,"updateTime",e)},expression:"searchForm.updateTime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{float:"right","margin-right":"60px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.getCronList}},[t._v("查 询 ")]),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.clickAddBtn}},[t._v("新 增")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){return t.getCronList("reset")}}},[t._v("重 置")])],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini",border:"","cell-style":{"text-align":"center"},"header-cell-style":{"text-align":"center"},"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{fixed:"left",prop:"id",label:"id",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"cronName",label:"任务名称",width:"250","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"execTime",label:"调度时间",width:"280","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"args",label:"调度参数",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"运行状态",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.statusMap[t.tableData[e.$index].status]))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"addTime",label:"创建时间",width:"250","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"250","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.execCases(t.tableData[e.$index].args)}}},[t._v("执行\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.cronDetail(t.tableData[e.$index].id,"edit")}}},[t._v("编辑\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.deleteCron(t.tableData[e.$index].id)}}},[t._v("删除\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.cronDetail(t.tableData[e.$index].id,"copy")}}},[t._v("复制\n        ")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total,slot, prev, pager, next, jumper",total:t.total,size:"mini"},on:{"current-change":function(e){return t.getCronList("search")},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}},[a("span",[t._v(t._s(t.pageSize)+"条/页")])]),t._v(" "),t.dialogVisible?a("cron-dialog",{attrs:{visible:t.dialogVisible,"cron-id":t.cronId,type:t.dialogVisibleType},on:{listenToChildEvent:t.callbackFunc}}):t._e()],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(t){a("jpEp")},"data-v-04398a7c",null);e.default=c.exports},zyha:function(t,e){}});
//# sourceMappingURL=12.a29455126abfcb8dee6c.js.map